import com.alibaba.fastjson.JSON;
import entity.RDD;
import entity.Stage;
import entity.event.JobStartEvent;
import entity.event.StageCompletedEvent;
import org.junit.jupiter.api.Test;
import utils.CacheSketcher;
import static org.junit.jupiter.api.Assertions.*;

import java.io.IOException;
import java.util.*;

public class TestCacheSketcher {
    @Test
    void testGenerateRef() {
        {
            Stage stage = new Stage();
            stage.rdds = new ArrayList<>();
            RDD[] rdds = new RDD[14];
            for(int i = 1; i < rdds.length; i++) {
                rdds[i] = new RDD();
                rdds[i].rddId = (long) i;
                rdds[i].rddParentIDs = new ArrayList<>();
                stage.rdds.add(rdds[i]);
            }
            rdds[1].rddParentIDs.add(4L);
            rdds[1].rddParentIDs.add(5L);
            rdds[2].rddParentIDs.add(6L);
            rdds[2].rddParentIDs.add(7L);
            rdds[3].rddParentIDs.add(8L);
            rdds[3].rddParentIDs.add(9L);
            rdds[10].rddParentIDs.add(1L);
            rdds[11].rddParentIDs.add(1L);
            rdds[11].rddParentIDs.add(2L);
            rdds[12].rddParentIDs.add(2L);
            rdds[12].rddParentIDs.add(3L);
            rdds[13].rddParentIDs.add(3L);
            Map<Long, Integer> mapForContrast = new HashMap<>();
            for(long l = 1L; l <= 9L; l++) {
                mapForContrast.put(l, 2);
            }
            Map<Long, Integer> generatedMap = CacheSketcher.generateRefPerStage(stage);
            assertEquals(mapForContrast.size(), generatedMap.size());
            for(Map.Entry<Long, Integer> entry : generatedMap.entrySet()) {
                assertEquals(entry.getValue(), mapForContrast.get(entry.getKey()));
            }
        }
        {
            Stage stage = new Stage();
            stage.rdds = new ArrayList<>();
            RDD[] rdds = new RDD[14];
            for(int i = 1; i < rdds.length; i++) {
                rdds[i] = new RDD();
                rdds[i].rddId = (long) i;
                rdds[i].rddParentIDs = new ArrayList<>();
                stage.rdds.add(rdds[i]);
            }
            rdds[1].rddParentIDs.add(4L);
            rdds[1].rddParentIDs.add(5L);
            rdds[1].rddParentIDs.add(6L);
            rdds[2].rddParentIDs.add(6L);
            rdds[2].rddParentIDs.add(7L);
            rdds[3].rddParentIDs.add(8L);
            rdds[3].rddParentIDs.add(9L);
            rdds[10].rddParentIDs.add(1L);
            rdds[11].rddParentIDs.add(1L);
            rdds[11].rddParentIDs.add(2L);
            rdds[12].rddParentIDs.add(2L);
            rdds[12].rddParentIDs.add(3L);
            rdds[13].rddParentIDs.add(3L);
            Map<Long, Integer> mapForContrast = new HashMap<>();
            for(long l = 1L; l <= 9L; l++) {
                mapForContrast.put(l, 2);
            }
            mapForContrast.put(6l, 4);
            Map<Long, Integer> generatedMap = CacheSketcher.generateRefPerStage(stage);
            assertEquals(mapForContrast.size(), generatedMap.size());
            for(Map.Entry<Long, Integer> entry : generatedMap.entrySet()) {
                assertEquals(entry.getValue(), mapForContrast.get(entry.getKey()));
            }
            assertEquals(generatedMap.get(6l), 4);
        }
    }

    // KEYPOINT
    @Test
    void testGenerateRefPerJob() {
        {
            JobStartEvent jse = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":2,\"Submission Time\":1636630211337,\"Stage Infos\":[{\"Stage ID\":9,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[7],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":5,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":6,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":10,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[9,7,8],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":7,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[5,6],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":11,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[10],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":8,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[9,5,6,10,7,11,8],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            int[] directRef = {4, 2, 1, 1, 1, 1, 1, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 0};
            int[] totalRef = {14, 5, 4, 4, 4, 4, 4, 4, 3, 2, 1, 1, 1, 1, 1, 1, 1, 0};
            Map<Long, Integer> refPerJob = CacheSketcher.generateRefPerJob(jse);
            assertEquals(18, totalRef.length);
            assertEquals(18, directRef.length);
            for(int i = 0; i <= 17; i++) {
                System.out.println("asserting Job 2: " + i);
                assertEquals(totalRef[i], refPerJob.get((long) i));
            }
        }
        {
            JobStartEvent jse = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":0,\"Submission Time\":1636630209838,\"Stage Infos\":[{\"Stage ID\":0,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:62\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:62)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[0],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            int[] totalRef = {0};
            Map<Long, Integer> refPerJob = CacheSketcher.generateRefPerJob(jse);
            assertEquals(1, totalRef.length);
            for(int i = 0; i <= 0; i++) {
                System.out.println("asserting Job 0: " + i);
                assertEquals(totalRef[i], refPerJob.get((long) i));
            }
        }
        {
            JobStartEvent jse = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":1,\"Submission Time\":1636630210525,\"Stage Infos\":[{\"Stage ID\":1,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":2,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":3,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[1,2],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":4,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[3],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[1,2,3,4],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            int[] totalRef = {3, 1, 1, 1, 1, 1, 1, 1, 1, 0};
            Map<Long, Integer> refPerJob = CacheSketcher.generateRefPerJob(jse);
            assertEquals(10, totalRef.length);
            for(int i = 0; i <= 9; i++) {
                System.out.println("asserting Job 1: " + i);
                assertEquals(totalRef[i], refPerJob.get((long) i));
            }
        }
        {
            int expectedLength = 18;
            JobStartEvent jse = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":3,\"Submission Time\":1636630211585,\"Stage Infos\":[{\"Stage ID\":15,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":12,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":16,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":13,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":17,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[15,16,14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":18,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:76\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[17],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:76)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":14,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[12,13],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[15,12,16,13,17,18,14],\"Properties\":{}}\n")
                .toJavaObject(JobStartEvent.class);
            int[] totalRef = {14, 5, 4, 4, 4, 4, 4, 4, 3, 2, 1, 1, 1, 1, 1, 1, 1, 0};
            Map<Long, Integer> refPerJob = CacheSketcher.generateRefPerJob(jse);
            assertEquals(expectedLength, totalRef.length);
            for(int i = 0; i < expectedLength; i++) {
                System.out.println("asserting Job 3: " + i);
                assertEquals(totalRef[i], refPerJob.get((long) i));
            }
        }
    }

    // KEYPOINT a
    @Test
    void testGenerateRefForMultiJob() {
        {
            JobStartEvent jse0 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":0,\"Submission Time\":1636630209838,\"Stage Infos\":[{\"Stage ID\":0,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:62\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:62)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[0],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse1 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":1,\"Submission Time\":1636630210525,\"Stage Infos\":[{\"Stage ID\":1,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":2,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":3,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[1,2],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":4,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[3],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[1,2,3,4],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse2 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":2,\"Submission Time\":1636630211337,\"Stage Infos\":[{\"Stage ID\":9,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[7],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":5,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":6,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":10,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[9,7,8],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":7,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[5,6],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":11,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[10],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":8,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[9,5,6,10,7,11,8],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse3 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":3,\"Submission Time\":1636630211585,\"Stage Infos\":[{\"Stage ID\":15,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":12,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":16,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":13,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":17,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[15,16,14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":18,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:76\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[17],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:76)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":14,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[12,13],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[15,12,16,13,17,18,14],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            List<JobStartEvent> jobList = new ArrayList<>();
            jobList.add(jse0);
            jobList.add(jse1);
            jobList.add(jse2);
            jobList.add(jse3);
            Map<Long, Integer> refForAllJobs = CacheSketcher.generateRefForJobs(jobList);
            assertEquals(18, refForAllJobs.size());
            int[] totalRef1= {0};
            int[] totalRef2 = {3, 1, 1, 1, 1, 1, 1, 1, 1, 0};
            int[] totalRef3 = {14, 5, 4, 4, 4, 4, 4, 4, 3, 2, 1, 1, 1, 1, 1, 1, 1, 0};
            int[] totalRef4 = {14, 5, 4, 4, 4, 4, 4, 4, 3, 2, 1, 1, 1, 1, 1, 1, 1, 0};
            // int[] totalRef = {31, 11, 9, 9, 9, 9, 9, 9, 7, 4, 2, 2, 2, 2, 2, 2, 2, 0};
            int[] totalRef = {32, 11, 9, 9, 9, 9, 9, 9, 7, 5, 2, 2, 2, 2, 2, 2, 2, 2};
            assertEquals(18, totalRef.length);
            for(int i = 0; i <= 17; i++) {
                System.out.println("asserting all jobs: " + i);
                assertEquals(totalRef[i], refForAllJobs.get((long) i));
            }
        }
    }

    @Test
    void testGeneratePartition() {
        {
            Stage stage = new Stage();
            stage.rdds = new ArrayList<>();
            RDD[] rdds = new RDD[14];
            for(int i = 1; i < rdds.length; i++) {
                rdds[i] = new RDD();
                rdds[i].rddId = (long) i;
                rdds[i].rddParentIDs = new ArrayList<>();
                rdds[i].partitionNum = (long) i;
                stage.rdds.add(rdds[i]);
            }
            rdds[1].rddParentIDs.add(4L);
            rdds[1].rddParentIDs.add(5L);
            rdds[2].rddParentIDs.add(6L);
            rdds[2].rddParentIDs.add(7L);
            rdds[3].rddParentIDs.add(8L);
            rdds[3].rddParentIDs.add(9L);
            rdds[10].rddParentIDs.add(1L);
            rdds[11].rddParentIDs.add(1L);
            rdds[11].rddParentIDs.add(2L);
            rdds[12].rddParentIDs.add(2L);
            rdds[12].rddParentIDs.add(3L);
            rdds[13].rddParentIDs.add(3L);
            Map<Long, Long> partitionForContrast = new HashMap<>();
            for(long l = 1L; l <= 13L; l++) {
                partitionForContrast.put(l, l);
            }
            Map<Long, Long> generatedPartition = CacheSketcher.generatePartitionPerStage(stage);
            assertEquals(partitionForContrast.size(), generatedPartition.size());
            for(Map.Entry<Long, Long> entry : generatedPartition.entrySet()) {
                assertEquals(entry.getValue(), partitionForContrast.get(entry.getKey()));
            }
        }
    }

    // KEYPOINT c
    @Test
    void testGeneratePartitionPerJob() {
        {
            JobStartEvent jse0 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":0,\"Submission Time\":1636630209838,\"Stage Infos\":[{\"Stage ID\":0,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:62\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:62)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[0],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            Map<Long, Long> rddPartition = CacheSketcher.generatePartitionPerJob(jse0);
            int maxLen = 1;
            assertEquals(maxLen, rddPartition.size());
            long[] partitions = {1};
            for(int i = 0; i < maxLen; i++) {
                System.out.println("asserting job 0: " + i);
                assertEquals(partitions[i], rddPartition.get((long) i));
            }
        }
        {
            JobStartEvent jse1 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":1,\"Submission Time\":1636630210525,\"Stage Infos\":[{\"Stage ID\":1,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":2,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":3,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[1,2],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":4,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[3],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[1,2,3,4],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            Map<Long, Long> rddPartition = CacheSketcher.generatePartitionPerJob(jse1);
            int maxLen = 10;
            assertEquals(maxLen, rddPartition.size());
            long[] partitions = {1, 1, 1, 1, 1, 1, 2, 2, 2, 2};
            for (int i = 0; i < maxLen; i++) {
                System.out.println("asserting job 1: " + i);
                assertEquals(partitions[i], rddPartition.get((long) i));
            }
        }
        {
            JobStartEvent jse = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":2,\"Submission Time\":1636630211337,\"Stage Infos\":[{\"Stage ID\":9,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[7],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":5,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":6,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":10,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[9,7,8],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":7,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[5,6],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":11,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[10],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":8,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[9,5,6,10,7,11,8],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            Map<Long, Long> rddPartition = CacheSketcher.generatePartitionPerJob(jse);
            int maxLen = 18;
            assertEquals(maxLen, rddPartition.size());
            long[] partitions = {1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 4, 4, 4, 4};
            for(int i = 0; i < maxLen; i++) {
                System.out.println("asserting job 2: " + i);
                assertEquals(partitions[i], rddPartition.get((long) i));
            }
        }
        {
            JobStartEvent jse3 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":3,\"Submission Time\":1636630211585,\"Stage Infos\":[{\"Stage ID\":15,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":12,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":16,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":13,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":17,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[15,16,14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":18,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:76\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[17],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:76)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":14,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[12,13],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[15,12,16,13,17,18,14],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            Map<Long, Long> rddPartition = CacheSketcher.generatePartitionPerJob(jse3);
            int maxLen = 18;
            assertEquals(maxLen, rddPartition.size());
            long[] partitions = {1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 4, 4, 4, 4};
            for(int i = 0; i < maxLen; i++) {
                System.out.println("asserting job 3: " + i);
                assertEquals(partitions[i], rddPartition.get((long) i));
            }
        }
        {
            JobStartEvent jse0 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":0,\"Submission Time\":1636630209838,\"Stage Infos\":[{\"Stage ID\":0,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:62\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:62)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[0],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse1 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":1,\"Submission Time\":1636630210525,\"Stage Infos\":[{\"Stage ID\":1,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":2,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":3,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[1,2],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":4,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[3],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[1,2,3,4],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse2 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":2,\"Submission Time\":1636630211337,\"Stage Infos\":[{\"Stage ID\":9,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[7],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":5,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":6,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":10,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[9,7,8],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":7,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[5,6],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":11,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[10],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":8,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[9,5,6,10,7,11,8],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse3 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":3,\"Submission Time\":1636630211585,\"Stage Infos\":[{\"Stage ID\":15,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":12,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":16,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":13,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":17,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[15,16,14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":18,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:76\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[17],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:76)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":14,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[12,13],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[15,12,16,13,17,18,14],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            Map<Long, Long> rddPartition = CacheSketcher.generatePartitionPerJob(jse0);
            // 
            for(Map.Entry<Long, Long> entry : CacheSketcher.generatePartitionPerJob(jse1).entrySet()) {
                assertTrue(rddPartition.putIfAbsent(entry.getKey(), entry.getValue()) == null ||
                        entry.getValue().equals(rddPartition.get(entry.getKey())));
            }
            for(Map.Entry<Long, Long> entry : CacheSketcher.generatePartitionPerJob(jse2).entrySet()) {
                assertTrue(rddPartition.putIfAbsent(entry.getKey(), entry.getValue()) == null ||
                        entry.getValue().equals(rddPartition.get(entry.getKey())));
            }
            for(Map.Entry<Long, Long> entry : CacheSketcher.generatePartitionPerJob(jse3).entrySet()) {
                assertTrue(rddPartition.putIfAbsent(entry.getKey(), entry.getValue()) == null ||
                        entry.getValue().equals(rddPartition.get(entry.getKey())));
            }
//            rddPartition.putAll(CacheSketcher.generatePartitionPerJob(jse1));
//            rddPartition.putAll(CacheSketcher.generatePartitionPerJob(jse2));
//            rddPartition.putAll(CacheSketcher.generatePartitionPerJob(jse3));
            int maxLen = 18;
            assertEquals(maxLen, rddPartition.size());
            long[] partitions = {1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 4, 4, 4, 4};
            for(int i = 0; i < maxLen; i++) {
                System.out.println("asserting job 0, 1, 2, 3: " + i);
                assertEquals(partitions[i], rddPartition.get((long) i));
            }
        }
        {
            JobStartEvent jse0 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":0,\"Submission Time\":1636630209838,\"Stage Infos\":[{\"Stage ID\":0,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:62\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:62)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[0],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse1 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":1,\"Submission Time\":1636630210525,\"Stage Infos\":[{\"Stage ID\":1,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":2,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":3,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[1,2],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":4,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[3],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[1,2,3,4],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse2 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":2,\"Submission Time\":1636630211337,\"Stage Infos\":[{\"Stage ID\":9,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[7],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":5,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":6,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":10,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[9,7,8],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":7,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[5,6],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":11,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[10],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":8,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[9,5,6,10,7,11,8],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse3 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":3,\"Submission Time\":1636630211585,\"Stage Infos\":[{\"Stage ID\":15,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":12,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":16,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":13,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":17,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[15,16,14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":18,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:76\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[17],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:76)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":14,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[12,13],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[15,12,16,13,17,18,14],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            List<JobStartEvent> jobs = new ArrayList<>();
            jobs.add(jse0);
            jobs.add(jse1);
            jobs.add(jse2);
            jobs.add(jse3);
            Map<Long, Long> rddPartition = CacheSketcher.generatePartitionForJobs(jobs);
            int maxLen = 18;
            assertEquals(maxLen, rddPartition.size());
            long[] partitions = {1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 4, 4, 4, 4};
            for(int i = 0; i < maxLen; i++) {
                System.out.println("asserting job 0, 1, 2, 3: " + i);
                assertEquals(partitions[i], rddPartition.get((long) i));
            }
        }
    }

    @Test
    void testGenerateRDDMapPerJob() {
        {
            Stage stage = new Stage();
            stage.rdds = new ArrayList<>();
            RDD[] rdds = new RDD[14];
            for(int i = 1; i < rdds.length; i++) {
                rdds[i] = new RDD();
                rdds[i].rddId = (long) i;
                rdds[i].rddParentIDs = new ArrayList<>();
                rdds[i].partitionNum = (long) i;
                stage.rdds.add(rdds[i]);
            }
            rdds[1].rddParentIDs.add(4L);
            rdds[1].rddParentIDs.add(5L);
            rdds[2].rddParentIDs.add(6L);
            rdds[2].rddParentIDs.add(7L);
            rdds[3].rddParentIDs.add(8L);
            rdds[3].rddParentIDs.add(9L);
            rdds[10].rddParentIDs.add(1L);
            rdds[11].rddParentIDs.add(1L);
            rdds[11].rddParentIDs.add(2L);
            rdds[12].rddParentIDs.add(2L);
            rdds[12].rddParentIDs.add(3L);
            rdds[13].rddParentIDs.add(3L);
            JobStartEvent jse = new JobStartEvent();
            jse.stages = new ArrayList<>();
            jse.stages.add(stage);
            Map<Long, RDD> rddMap = CacheSketcher.generateRDDMapPerJob(jse);
            assertEquals(rddMap.size(), 13);
        }
        {
            JobStartEvent jse = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":2,\"Submission Time\":1636630211337,\"Stage Infos\":[{\"Stage ID\":9,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[7],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":5,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":6,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":10,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[9,7,8],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":7,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[5,6],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":11,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[10],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":8,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[9,5,6,10,7,11,8],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            Map<Long, RDD> rddMap = CacheSketcher.generateRDDMapPerJob(jse);
            assertEquals(rddMap.size(), 18);
        }
    }

    // KEYPOINT: 
    @Test
    void testGenerateRDDDirectRefPerJob() {
        {
            Stage stage = new Stage();
            stage.rdds = new ArrayList<>();
            RDD[] rdds = new RDD[14];
            for(int i = 1; i < rdds.length; i++) {
                rdds[i] = new RDD();
                rdds[i].rddId = (long) i;
                rdds[i].rddParentIDs = new ArrayList<>();
                rdds[i].partitionNum = (long) i;
                stage.rdds.add(rdds[i]);
            }
            rdds[1].rddParentIDs.add(4L);
            rdds[1].rddParentIDs.add(5L);
            rdds[2].rddParentIDs.add(6L);
            rdds[2].rddParentIDs.add(7L);
            rdds[3].rddParentIDs.add(8L);
            rdds[3].rddParentIDs.add(9L);
            rdds[10].rddParentIDs.add(1L);
            rdds[11].rddParentIDs.add(1L);
            rdds[11].rddParentIDs.add(2L);
            rdds[12].rddParentIDs.add(2L);
            rdds[12].rddParentIDs.add(3L);
            rdds[13].rddParentIDs.add(3L);
            JobStartEvent jse = new JobStartEvent();
            jse.stages = new ArrayList<>();
            jse.stages.add(stage);
            Map<Long, Integer> directRef = CacheSketcher.generateRDDDirectRefPerJob(jse, null);
            assertEquals(directRef.size(), 13);
            assertEquals(directRef.get(1L), 2);
            assertEquals(directRef.get(2L), 2);
            assertEquals(directRef.get(3L), 2);
            assertEquals(directRef.get(4L), 1);
            assertEquals(directRef.get(5L), 1);
            assertEquals(directRef.get(6L), 1);
            assertEquals(directRef.get(7L), 1);
            assertEquals(directRef.get(8L), 1);
            assertEquals(directRef.get(9L), 1);
            assertEquals(directRef.get(10L), 0);
            assertEquals(directRef.get(11L), 0);
            assertEquals(directRef.get(12L), 0);
            assertEquals(directRef.get(13L), 0);
        }
        {
            JobStartEvent jse3 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":3,\"Submission Time\":1636630211585,\"Stage Infos\":[{\"Stage ID\":15,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":12,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":16,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":13,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":17,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[15,16,14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":18,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:76\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[17],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:76)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":14,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[12,13],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[15,12,16,13,17,18,14],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            Map<Long, Integer> directRef = CacheSketcher.generateRDDDirectRefPerJob(jse3, null);
            int[] contrastRef = {4, 2, 1, 1, 1, 1, 1, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 0};
            assertEquals(18, contrastRef.length);
            for(int i = 0; i <= 17; i++) {
                System.out.println("asserting " + i);
                assertEquals(contrastRef[i], directRef.get((long) i));
            }
        }
        {
            JobStartEvent jse = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":2,\"Submission Time\":1636630211337,\"Stage Infos\":[{\"Stage ID\":9,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[7],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":5,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":6,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":10,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[9,7,8],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":7,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[5,6],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":11,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[10],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":8,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[9,5,6,10,7,11,8],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            Map<Long, Integer> directRef = CacheSketcher.generateRDDDirectRefPerJob(jse, null);
            int[] contrastRef = {4, 2, 1, 1, 1, 1, 1, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 0};
            assertEquals(18, contrastRef.length);
            for(int i = 0; i <= 17; i++) {
                System.out.println("asserting " + i);
                assertEquals(contrastRef[i], directRef.get((long) i));
            }
        }
        {
            JobStartEvent jse = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":1,\"Submission Time\":1636630210525,\"Stage Infos\":[{\"Stage ID\":1,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":2,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":3,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[1,2],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":4,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[3],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[1,2,3,4],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            Map<Long, Integer> directRef = CacheSketcher.generateRDDDirectRefPerJob(jse, null);
            int[] contrastRef = {3, 1, 1, 1, 1, 1, 1, 1, 1, 0};
            assertEquals(10, contrastRef.length);
            for(int i = 0; i <= 9; i++) {
                System.out.println("asserting Job 1: " + i);
                assertEquals(contrastRef[i], directRef.get((long) i));
            }
        }
        {
            JobStartEvent jse0 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":0,\"Submission Time\":1636630209838,\"Stage Infos\":[{\"Stage ID\":0,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:62\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:62)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[0],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            Map<Long, Integer> directRef = CacheSketcher.generateRDDDirectRefPerJob(jse0, null);
            int[] contrastRef = {0};
            assertEquals(1, contrastRef.length);
            for(int i = 0; i <= 0; i++) {
                System.out.println("asserting Job 0: " + i);
                assertEquals(contrastRef[i], directRef.get((long) i));
            }
        }
        {
            JobStartEvent jse0 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":0,\"Submission Time\":1636630209838,\"Stage Infos\":[{\"Stage ID\":0,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:62\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:62)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[0],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse1 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":1,\"Submission Time\":1636630210525,\"Stage Infos\":[{\"Stage ID\":1,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":2,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":3,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[1,2],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":4,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[3],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[1,2,3,4],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse2 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":2,\"Submission Time\":1636630211337,\"Stage Infos\":[{\"Stage ID\":9,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[7],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":5,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":6,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":10,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[9,7,8],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":7,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[5,6],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":11,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[10],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":8,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[9,5,6,10,7,11,8],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse3 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":3,\"Submission Time\":1636630211585,\"Stage Infos\":[{\"Stage ID\":15,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":12,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":16,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":13,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":17,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[15,16,14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":18,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:76\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[17],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:76)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":14,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[12,13],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[15,12,16,13,17,18,14],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            List<JobStartEvent> jobs = new ArrayList<>();
            jobs.add(jse0);
            jobs.add(jse1);
            jobs.add(jse2);
            jobs.add(jse3);
            Map<Long, Integer> directRef = CacheSketcher.generateRDDDirectRefForJobs(jobs, null);
            int[] contrastRef0 = {0};
            int[] contrastRef1 = {3, 1, 1, 1, 1, 1, 1, 1, 1, 0};
            int[] contrastRef2 = {4, 2, 1, 1, 1, 1, 1, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 0};
            int[] contrastRef3 = {4, 2, 1, 1, 1, 1, 1, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 0};
            // int[] contrastRef = {11, 5, 3, 3, 3, 3, 3, 5, 5, 4, 2, 2, 2, 2, 2, 2, 2, 0};
            int[] contrastRef = {12, 5, 3, 3, 3, 3, 3, 5, 5, 5, 2, 2, 2, 2, 2, 2, 2, 2};
            assertEquals(18, contrastRef.length);
            for(int i = 0; i <= 0; i++) {
                System.out.println("asserting Job 0, 1, 2, 4: " + i);
                assertEquals(contrastRef[i], directRef.get((long) i));
            }
        }
    }

    @Test
    void testGenerateSimpleDAGByJobsAndStages() {
        {
            JobStartEvent jse0 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":0,\"Submission Time\":1636630209838,\"Stage Infos\":[{\"Stage ID\":0,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:62\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:62)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[0],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse1 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":1,\"Submission Time\":1636630210525,\"Stage Infos\":[{\"Stage ID\":1,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":2,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":3,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[1,2],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":4,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[3],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[1,2,3,4],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse2 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":2,\"Submission Time\":1636630211337,\"Stage Infos\":[{\"Stage ID\":9,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[7],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":5,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":6,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":10,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[9,7,8],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":7,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[5,6],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":11,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[10],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":8,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[9,5,6,10,7,11,8],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse3 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":3,\"Submission Time\":1636630211585,\"Stage Infos\":[{\"Stage ID\":15,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":12,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":16,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":13,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":17,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[15,16,14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":18,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:76\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[17],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:76)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":14,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[12,13],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[15,12,16,13,17,18,14],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            List<JobStartEvent> jobs = new ArrayList<>();
            jobs.add(jse0);
            jobs.add(jse1);
            jobs.add(jse2);
            jobs.add(jse3);
            int[][] simpleDAG = CacheSketcher.generateSimpleDAGByJobsAndStages(jobs, null);
            assertEquals(18 + 4, simpleDAG.length);
            List<Integer> biggerThanZero = new ArrayList<>();
            for(int i = 0; i < 18; i++) {
                int sum = 0;
                for(int j = 0; j < 22; j++) {
                    if(simpleDAG[i][j] > 0) {
                        sum += 1;
                    }
                }
                if(sum > 1) {
                    biggerThanZero.add(i);
                }
            }
            System.out.println("hot data: " + biggerThanZero);
            assertEquals(4, biggerThanZero.size());
            int[] contrastArr = {0, 1, 9, 17};
            for(int i = 0; i < contrastArr.length; i++) {
                assertEquals(contrastArr[i], biggerThanZero.get(i));
            }
        }
        {
            JobStartEvent jse0 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":0,\"Submission Time\":1636630209838,\"Stage Infos\":[{\"Stage ID\":0,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:62\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:62)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[0],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse1 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":1,\"Submission Time\":1636630210525,\"Stage Infos\":[{\"Stage ID\":1,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":2,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":3,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[1,2],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":4,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[3],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[1,2,3,4],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse2 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":2,\"Submission Time\":1636630211337,\"Stage Infos\":[{\"Stage ID\":9,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[7],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":5,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":6,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":10,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[9,7,8],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":7,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[5,6],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":11,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[10],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":8,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[9,5,6,10,7,11,8],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse3 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":3,\"Submission Time\":1636630211585,\"Stage Infos\":[{\"Stage ID\":15,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":12,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":16,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":13,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":17,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[15,16,14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":18,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:76\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[17],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:76)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":14,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[12,13],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[15,12,16,13,17,18,14],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            List<JobStartEvent> jobs = new ArrayList<>();
            jobs.add(jse0);
            jobs.add(jse1);
            jobs.add(jse2);
            jobs.add(jse3);
            StageCompletedEvent sce0 = JSON.parseObject("{\"Event\":\"SparkListenerStageCompleted\",\"Stage Info\":{\"Stage ID\":0,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:62\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:62)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Submission Time\":1636630209870,\"Completion Time\":1636630210434,\"Accumulables\":[{\"ID\":2,\"Name\":\"internal.metrics.executorRunTime\",\"Value\":72,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":4,\"Name\":\"internal.metrics.resultSize\",\"Value\":789,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":1,\"Name\":\"internal.metrics.executorDeserializeCpuTime\",\"Value\":159975753,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":3,\"Name\":\"internal.metrics.executorCpuTime\",\"Value\":60086427,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":6,\"Name\":\"internal.metrics.resultSerializationTime\",\"Value\":1,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":0,\"Name\":\"internal.metrics.executorDeserializeTime\",\"Value\":233,\"Internal\":true,\"Count Failed Values\":true}]}}\n")
                    .toJavaObject(StageCompletedEvent.class);
            StageCompletedEvent sce1 = JSON.parseObject("{\"Event\":\"SparkListenerStageCompleted\",\"Stage Info\":{\"Stage ID\":1,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Submission Time\":1636630210535,\"Completion Time\":1636630210632,\"Accumulables\":[{\"ID\":44,\"Name\":\"internal.metrics.shuffle.write.recordsWritten\",\"Value\":200,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":26,\"Name\":\"internal.metrics.executorDeserializeCpuTime\",\"Value\":15375114,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":47,\"Name\":\"internal.metrics.input.recordsRead\",\"Value\":200,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":29,\"Name\":\"internal.metrics.resultSize\",\"Value\":1012,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":46,\"Name\":\"internal.metrics.input.bytesRead\",\"Value\":7216,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":31,\"Name\":\"internal.metrics.resultSerializationTime\",\"Value\":1,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":43,\"Name\":\"internal.metrics.shuffle.write.bytesWritten\",\"Value\":1504,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":25,\"Name\":\"internal.metrics.executorDeserializeTime\",\"Value\":25,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":28,\"Name\":\"internal.metrics.executorCpuTime\",\"Value\":19521626,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":45,\"Name\":\"internal.metrics.shuffle.write.writeTime\",\"Value\":5487950,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":27,\"Name\":\"internal.metrics.executorRunTime\",\"Value\":21,\"Internal\":true,\"Count Failed Values\":true}]}}\n")
                    .toJavaObject(StageCompletedEvent.class);
            StageCompletedEvent sce2 = JSON.parseObject("{\"Event\":\"SparkListenerStageCompleted\",\"Stage Info\":{\"Stage ID\":2,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Submission Time\":1636630210563,\"Completion Time\":1636630210669,\"Accumulables\":[{\"ID\":68,\"Name\":\"internal.metrics.shuffle.write.bytesWritten\",\"Value\":1495,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":50,\"Name\":\"internal.metrics.executorDeserializeTime\",\"Value\":26,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":71,\"Name\":\"internal.metrics.input.bytesRead\",\"Value\":7216,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":53,\"Name\":\"internal.metrics.executorCpuTime\",\"Value\":6041561,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":70,\"Name\":\"internal.metrics.shuffle.write.writeTime\",\"Value\":653409,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":52,\"Name\":\"internal.metrics.executorRunTime\",\"Value\":7,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":69,\"Name\":\"internal.metrics.shuffle.write.recordsWritten\",\"Value\":200,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":72,\"Name\":\"internal.metrics.input.recordsRead\",\"Value\":200,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":54,\"Name\":\"internal.metrics.resultSize\",\"Value\":969,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":51,\"Name\":\"internal.metrics.executorDeserializeCpuTime\",\"Value\":12733333,\"Internal\":true,\"Count Failed Values\":true}]}}\n")
                    .toJavaObject(StageCompletedEvent.class);
            StageCompletedEvent sce3 = JSON.parseObject("{\"Event\":\"SparkListenerStageCompleted\",\"Stage Info\":{\"Stage ID\":3,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[1,2],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Submission Time\":1636630210675,\"Completion Time\":1636630211154,\"Accumulables\":[{\"ID\":92,\"Name\":\"internal.metrics.shuffle.read.recordsRead\",\"Value\":400,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":83,\"Name\":\"internal.metrics.diskBytesSpilled\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":95,\"Name\":\"internal.metrics.shuffle.write.writeTime\",\"Value\":1556842,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":86,\"Name\":\"internal.metrics.shuffle.read.remoteBlocksFetched\",\"Value\":2,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":77,\"Name\":\"internal.metrics.executorRunTime\",\"Value\":261,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":89,\"Name\":\"internal.metrics.shuffle.read.remoteBytesReadToDisk\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":91,\"Name\":\"internal.metrics.shuffle.read.fetchWaitTime\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":82,\"Name\":\"internal.metrics.memoryBytesSpilled\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":94,\"Name\":\"internal.metrics.shuffle.write.recordsWritten\",\"Value\":644,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":76,\"Name\":\"internal.metrics.executorDeserializeCpuTime\",\"Value\":185437207,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":88,\"Name\":\"internal.metrics.shuffle.read.remoteBytesRead\",\"Value\":2999,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":97,\"Name\":\"internal.metrics.input.recordsRead\",\"Value\":200,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":79,\"Name\":\"internal.metrics.resultSize\",\"Value\":2456,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":87,\"Name\":\"internal.metrics.shuffle.read.localBlocksFetched\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":96,\"Name\":\"internal.metrics.input.bytesRead\",\"Value\":7216,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":78,\"Name\":\"internal.metrics.executorCpuTime\",\"Value\":237899438,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":90,\"Name\":\"internal.metrics.shuffle.read.localBytesRead\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":81,\"Name\":\"internal.metrics.resultSerializationTime\",\"Value\":1,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":75,\"Name\":\"internal.metrics.executorDeserializeTime\",\"Value\":239,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":84,\"Name\":\"internal.metrics.peakExecutionMemory\",\"Value\":71356,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":93,\"Name\":\"internal.metrics.shuffle.write.bytesWritten\",\"Value\":4778,\"Internal\":true,\"Count Failed Values\":true}]}}\n").
                    toJavaObject(StageCompletedEvent.class);
            StageCompletedEvent sce4 = JSON.parseObject("{\"Event\":\"SparkListenerStageCompleted\",\"Stage Info\":{\"Stage ID\":4,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[3],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Submission Time\":1636630211165,\"Completion Time\":1636630211303,\"Accumulables\":[{\"ID\":101,\"Name\":\"internal.metrics.executorDeserializeCpuTime\",\"Value\":26895281,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":104,\"Name\":\"internal.metrics.resultSize\",\"Value\":2395,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":113,\"Name\":\"internal.metrics.shuffle.read.remoteBytesRead\",\"Value\":2213,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":116,\"Name\":\"internal.metrics.shuffle.read.fetchWaitTime\",\"Value\":17,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":107,\"Name\":\"internal.metrics.memoryBytesSpilled\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":106,\"Name\":\"internal.metrics.resultSerializationTime\",\"Value\":1,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":115,\"Name\":\"internal.metrics.shuffle.read.localBytesRead\",\"Value\":2565,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":100,\"Name\":\"internal.metrics.executorDeserializeTime\",\"Value\":53,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":109,\"Name\":\"internal.metrics.peakExecutionMemory\",\"Value\":29888,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":103,\"Name\":\"internal.metrics.executorCpuTime\",\"Value\":97836070,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":112,\"Name\":\"internal.metrics.shuffle.read.localBlocksFetched\",\"Value\":2,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":114,\"Name\":\"internal.metrics.shuffle.read.remoteBytesReadToDisk\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":117,\"Name\":\"internal.metrics.shuffle.read.recordsRead\",\"Value\":644,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":108,\"Name\":\"internal.metrics.diskBytesSpilled\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":102,\"Name\":\"internal.metrics.executorRunTime\",\"Value\":133,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":111,\"Name\":\"internal.metrics.shuffle.read.remoteBlocksFetched\",\"Value\":2,\"Internal\":true,\"Count Failed Values\":true}]}}\n")
                    .toJavaObject(StageCompletedEvent.class);
            StageCompletedEvent sce8 = JSON.parseObject("{\"Event\":\"SparkListenerStageCompleted\",\"Stage Info\":{\"Stage ID\":8,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Submission Time\":1636630211341,\"Completion Time\":1636630211383,\"Accumulables\":[{\"ID\":146,\"Name\":\"internal.metrics.input.bytesRead\",\"Value\":7216,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":128,\"Name\":\"internal.metrics.executorCpuTime\",\"Value\":3743816,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":125,\"Name\":\"internal.metrics.executorDeserializeTime\",\"Value\":16,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":145,\"Name\":\"internal.metrics.shuffle.write.writeTime\",\"Value\":963450,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":127,\"Name\":\"internal.metrics.executorRunTime\",\"Value\":4,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":147,\"Name\":\"internal.metrics.input.recordsRead\",\"Value\":200,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":129,\"Name\":\"internal.metrics.resultSize\",\"Value\":970,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":144,\"Name\":\"internal.metrics.shuffle.write.recordsWritten\",\"Value\":200,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":126,\"Name\":\"internal.metrics.executorDeserializeCpuTime\",\"Value\":6626278,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":143,\"Name\":\"internal.metrics.shuffle.write.bytesWritten\",\"Value\":1711,\"Internal\":true,\"Count Failed Values\":true}]}}\n")
                    .toJavaObject(StageCompletedEvent.class);
            StageCompletedEvent sce9 = JSON.parseObject("{\"Event\":\"SparkListenerStageCompleted\",\"Stage Info\":{\"Stage ID\":9,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[7],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Submission Time\":1636630211355,\"Completion Time\":1636630211409,\"Accumulables\":[{\"ID\":169,\"Name\":\"internal.metrics.shuffle.write.recordsWritten\",\"Value\":633,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":151,\"Name\":\"internal.metrics.executorDeserializeCpuTime\",\"Value\":14816378,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":172,\"Name\":\"internal.metrics.input.recordsRead\",\"Value\":633,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":154,\"Name\":\"internal.metrics.resultSize\",\"Value\":1940,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":168,\"Name\":\"internal.metrics.shuffle.write.bytesWritten\",\"Value\":4870,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":150,\"Name\":\"internal.metrics.executorDeserializeTime\",\"Value\":31,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":171,\"Name\":\"internal.metrics.input.bytesRead\",\"Value\":22824,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":153,\"Name\":\"internal.metrics.executorCpuTime\",\"Value\":12597439,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":170,\"Name\":\"internal.metrics.shuffle.write.writeTime\",\"Value\":4875632,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":152,\"Name\":\"internal.metrics.executorRunTime\",\"Value\":12,\"Internal\":true,\"Count Failed Values\":true}]}}\n")
                    .toJavaObject(StageCompletedEvent.class);
            StageCompletedEvent sce10 = JSON.parseObject("{\"Event\":\"SparkListenerStageCompleted\",\"Stage Info\":{\"Stage ID\":10,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[9,7,8],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Submission Time\":1636630211412,\"Completion Time\":1636630211505,\"Accumulables\":[{\"ID\":191,\"Name\":\"internal.metrics.shuffle.read.fetchWaitTime\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":182,\"Name\":\"internal.metrics.memoryBytesSpilled\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":176,\"Name\":\"internal.metrics.executorDeserializeCpuTime\",\"Value\":15984192,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":194,\"Name\":\"internal.metrics.shuffle.write.recordsWritten\",\"Value\":1977,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":175,\"Name\":\"internal.metrics.executorDeserializeTime\",\"Value\":31,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":184,\"Name\":\"internal.metrics.peakExecutionMemory\",\"Value\":159444,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":193,\"Name\":\"internal.metrics.shuffle.write.bytesWritten\",\"Value\":14410,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":187,\"Name\":\"internal.metrics.shuffle.read.localBlocksFetched\",\"Value\":3,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":178,\"Name\":\"internal.metrics.executorCpuTime\",\"Value\":75756569,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":196,\"Name\":\"internal.metrics.input.bytesRead\",\"Value\":22824,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":190,\"Name\":\"internal.metrics.shuffle.read.localBytesRead\",\"Value\":3321,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":189,\"Name\":\"internal.metrics.shuffle.read.remoteBytesReadToDisk\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":183,\"Name\":\"internal.metrics.diskBytesSpilled\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":192,\"Name\":\"internal.metrics.shuffle.read.recordsRead\",\"Value\":833,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":186,\"Name\":\"internal.metrics.shuffle.read.remoteBlocksFetched\",\"Value\":3,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":177,\"Name\":\"internal.metrics.executorRunTime\",\"Value\":95,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":195,\"Name\":\"internal.metrics.shuffle.write.writeTime\",\"Value\":778310,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":188,\"Name\":\"internal.metrics.shuffle.read.remoteBytesRead\",\"Value\":3260,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":179,\"Name\":\"internal.metrics.resultSize\",\"Value\":4834,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":197,\"Name\":\"internal.metrics.input.recordsRead\",\"Value\":633,\"Internal\":true,\"Count Failed Values\":true}]}}\n")
                    .toJavaObject(StageCompletedEvent.class);
            StageCompletedEvent sce11 = JSON.parseObject("{\"Event\":\"SparkListenerStageCompleted\",\"Stage Info\":{\"Stage ID\":11,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[10],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Submission Time\":1636630211508,\"Completion Time\":1636630211576,\"Accumulables\":[{\"ID\":200,\"Name\":\"internal.metrics.executorDeserializeTime\",\"Value\":27,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":209,\"Name\":\"internal.metrics.peakExecutionMemory\",\"Value\":67475,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":202,\"Name\":\"internal.metrics.executorRunTime\",\"Value\":71,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":211,\"Name\":\"internal.metrics.shuffle.read.remoteBlocksFetched\",\"Value\":8,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":214,\"Name\":\"internal.metrics.shuffle.read.remoteBytesReadToDisk\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":217,\"Name\":\"internal.metrics.shuffle.read.recordsRead\",\"Value\":1977,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":208,\"Name\":\"internal.metrics.diskBytesSpilled\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":216,\"Name\":\"internal.metrics.shuffle.read.fetchWaitTime\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":207,\"Name\":\"internal.metrics.memoryBytesSpilled\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":201,\"Name\":\"internal.metrics.executorDeserializeCpuTime\",\"Value\":14164169,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":213,\"Name\":\"internal.metrics.shuffle.read.remoteBytesRead\",\"Value\":9487,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":204,\"Name\":\"internal.metrics.resultSize\",\"Value\":4704,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":203,\"Name\":\"internal.metrics.executorCpuTime\",\"Value\":52903614,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":212,\"Name\":\"internal.metrics.shuffle.read.localBlocksFetched\",\"Value\":4,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":215,\"Name\":\"internal.metrics.shuffle.read.localBytesRead\",\"Value\":4923,\"Internal\":true,\"Count Failed Values\":true}]}}\n")
                    .toJavaObject(StageCompletedEvent.class);
            StageCompletedEvent sce18 = JSON.parseObject("{\"Event\":\"SparkListenerStageCompleted\",\"Stage Info\":{\"Stage ID\":18,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:76\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[17],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:76)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Submission Time\":1636630211587,\"Completion Time\":1636630211643,\"Accumulables\":[{\"ID\":227,\"Name\":\"internal.metrics.executorRunTime\",\"Value\":3,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":226,\"Name\":\"internal.metrics.executorDeserializeCpuTime\",\"Value\":12773473,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":247,\"Name\":\"internal.metrics.input.recordsRead\",\"Value\":1427,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":229,\"Name\":\"internal.metrics.resultSize\",\"Value\":3285,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":225,\"Name\":\"internal.metrics.executorDeserializeTime\",\"Value\":26,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":246,\"Name\":\"internal.metrics.input.bytesRead\",\"Value\":51448,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":228,\"Name\":\"internal.metrics.executorCpuTime\",\"Value\":3382306,\"Internal\":true,\"Count Failed Values\":true}]}}\n")
                    .toJavaObject(StageCompletedEvent.class);
            List<StageCompletedEvent> stages = new ArrayList<>();
            StageCompletedEvent[] sces = {sce0, sce1, sce2, sce3, sce4, sce8, sce9, sce10, sce11, sce18};
            for(StageCompletedEvent sce : sces) {
                stages.add(sce);
            }
            int[][] simpleDAG = CacheSketcher.generateSimpleDAGByJobsAndStages(jobs, stages);
            assertEquals(18 + 4, simpleDAG.length);
            List<Integer> biggerThanZero = new ArrayList<>();
            for(int i = 0; i < 18; i++) {
                int sum = 0;
                for(int j = 0; j < 22; j++) {
                    if(simpleDAG[i][j] > 0) {
                        sum += 1;
                    }
                }
                if(sum > 1) {
                    biggerThanZero.add(i);
                }
            }
            System.out.println("hot data: " + biggerThanZero);
            assertEquals(4, biggerThanZero.size());
            int[] contrastArr = {0, 1, 9, 17};
            for(int i = 0; i < contrastArr.length; i++) {
                assertEquals(contrastArr[i], biggerThanZero.get(i));
            }
        }
        {
            JobStartEvent jse0 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":0,\"Submission Time\":1638155418765,\"Stage Infos\":[{\"Stage ID\":0,\"Stage Attempt ID\":0,\"Stage Name\":\"count at GraphLoader.scala:94\",\"Number of Tasks\":10,\"RDD Info\":[{\"RDD ID\":3,\"Name\":\"GraphLoader.edgeListFile - edges (hdfs://node1:9000/SparkBench/ShortestPaths/Input)\",\"Scope\":\"{\\\"id\\\":\\\"2\\\",\\\"name\\\":\\\"mapPartitionsWithIndex\\\"}\",\"Callsite\":\"mapPartitionsWithIndex at GraphLoader.scala:75\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":true,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"hdfs://node1:9000/SparkBench/ShortestPaths/Input\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"textFile\\\"}\",\"Callsite\":\"textFile at GraphLoader.scala:71\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":13,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":1,\"Name\":\"hdfs://node1:9000/SparkBench/ShortestPaths/Input\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"textFile\\\"}\",\"Callsite\":\"textFile at GraphLoader.scala:71\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":13,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoalescedRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"coalesce\\\"}\",\"Callsite\":\"coalesce at GraphLoader.scala:71\",\"Parent IDs\":[1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.graphx.GraphLoader$.edgeListFile(GraphLoader.scala:94)\\nsrc.main.scala.ShortestPathsApp$.main(ShortestPathsApp.scala:56)\\nsrc.main.scala.ShortestPathsApp.main(ShortestPathsApp.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.JavaMainApplication.start(SparkApplication.scala:52)\\norg.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:845)\\norg.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:161)\\norg.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:184)\\norg.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:86)\\norg.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:920)\\norg.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:929)\\norg.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)\",\"Accumulables\":[]}],\"Stage IDs\":[0],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse1 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":1,\"Submission Time\":1638155528181,\"Stage Infos\":[{\"Stage ID\":1,\"Stage Attempt ID\":0,\"Stage Name\":\"mapPartitions at VertexRDD.scala:356\",\"Number of Tasks\":10,\"RDD Info\":[{\"RDD ID\":6,\"Name\":\"VertexRDD.createRoutingTables - vid2pid (aggregation)\",\"Scope\":\"{\\\"id\\\":\\\"7\\\",\\\"name\\\":\\\"mapPartitions\\\"}\",\"Callsite\":\"mapPartitions at VertexRDD.scala:356\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"hdfs://node1:9000/SparkBench/ShortestPaths/Input\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"textFile\\\"}\",\"Callsite\":\"textFile at GraphLoader.scala:71\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":13,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":1,\"Name\":\"hdfs://node1:9000/SparkBench/ShortestPaths/Input\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"textFile\\\"}\",\"Callsite\":\"textFile at GraphLoader.scala:71\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":13,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoalescedRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"coalesce\\\"}\",\"Callsite\":\"coalesce at GraphLoader.scala:71\",\"Parent IDs\":[1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"GraphLoader.edgeListFile - edges (hdfs://node1:9000/SparkBench/ShortestPaths/Input), EdgeRDD, EdgeRDD\",\"Scope\":\"{\\\"id\\\":\\\"2\\\",\\\"name\\\":\\\"mapPartitionsWithIndex\\\"}\",\"Callsite\":\"mapPartitionsWithIndex at GraphLoader.scala:75\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":true,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.mapPartitions(RDD.scala:819)\\norg.apache.spark.graphx.VertexRDD$.createRoutingTables(VertexRDD.scala:356)\\norg.apache.spark.graphx.VertexRDD$.fromEdges(VertexRDD.scala:344)\\norg.apache.spark.graphx.impl.GraphImpl$.fromEdgeRDD(GraphImpl.scala:361)\\norg.apache.spark.graphx.impl.GraphImpl$.fromEdgePartitions(GraphImpl.scala:300)\\norg.apache.spark.graphx.GraphLoader$.edgeListFile(GraphLoader.scala:98)\\nsrc.main.scala.ShortestPathsApp$.main(ShortestPathsApp.scala:56)\\nsrc.main.scala.ShortestPathsApp.main(ShortestPathsApp.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.JavaMainApplication.start(SparkApplication.scala:52)\\norg.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:845)\\norg.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:161)\\norg.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:184)\\norg.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:86)\\norg.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:920)\\norg.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:929)\\norg.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)\",\"Accumulables\":[]},{\"Stage ID\":5,\"Stage Attempt ID\":0,\"Stage Name\":\"fold at VertexRDDImpl.scala:90\",\"Number of Tasks\":10,\"RDD Info\":[{\"RDD ID\":32,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"24\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at VertexRDDImpl.scala:90\",\"Parent IDs\":[30],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":30,\"Name\":\"VertexRDD\",\"Scope\":\"{\\\"id\\\":\\\"23\\\",\\\"name\\\":\\\"zipPartitions\\\"}\",\"Callsite\":\"zipPartitions at VertexRDDImpl.scala:215\",\"Parent IDs\":[16,29],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":29,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"partitionBy\\\"}\",\"Callsite\":\"partitionBy at VertexRDDImpl.scala:214\",\"Parent IDs\":[28],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"VertexRDD, VertexRDD\",\"Scope\":\"{\\\"id\\\":\\\"10\\\",\\\"name\\\":\\\"mapPartitions\\\"}\",\"Callsite\":\"mapPartitions at VertexRDD.scala:345\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"VertexRDD\",\"Scope\":\"{\\\"id\\\":\\\"13\\\",\\\"name\\\":\\\"mapPartitions\\\"}\",\"Callsite\":\"mapPartitions at VertexRDDImpl.scala:96\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":true,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"VertexRDD\",\"Scope\":\"{\\\"id\\\":\\\"11\\\",\\\"name\\\":\\\"mapPartitions\\\"}\",\"Callsite\":\"mapPartitions at VertexRDDImpl.scala:96\",\"Parent IDs\":[9],\"Storage Level\":{\"Use Disk\":true,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"9\\\",\\\"name\\\":\\\"mapPartitions\\\"}\",\"Callsite\":\"mapPartitions at VertexRDD.scala:361\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":7,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"8\\\",\\\"name\\\":\\\"partitionBy\\\"}\",\"Callsite\":\"partitionBy at VertexRDD.scala:361\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[1,4],\"Details\":\"org.apache.spark.rdd.RDD.fold(RDD.scala:1137)\\norg.apache.spark.graphx.impl.VertexRDDImpl.count(VertexRDDImpl.scala:90)\\norg.apache.spark.graphx.Pregel$.apply(Pregel.scala:140)\\norg.apache.spark.graphx.lib.ShortestPaths$.run(ShortestPaths.scala:71)\\nsrc.main.scala.ShortestPathsApp$.main(ShortestPathsApp.scala:71)\\nsrc.main.scala.ShortestPathsApp.main(ShortestPathsApp.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.JavaMainApplication.start(SparkApplication.scala:52)\\norg.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:845)\\norg.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:161)\\norg.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:184)\\norg.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:86)\\norg.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:920)\\norg.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:929)\\norg.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)\",\"Accumulables\":[]},{\"Stage ID\":2,\"Stage Attempt ID\":0,\"Stage Name\":\"mapPartitions at VertexRDDImpl.scala:247\",\"Number of Tasks\":10,\"RDD Info\":[{\"RDD ID\":20,\"Name\":\"ReplicatedVertexView.updateVertices - shippedVerts false false (broadcast)\",\"Scope\":\"{\\\"id\\\":\\\"15\\\",\\\"name\\\":\\\"mapPartitions\\\"}\",\"Callsite\":\"mapPartitions at VertexRDDImpl.scala:247\",\"Parent IDs\":[18],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":18,\"Name\":\"VertexRDD\",\"Scope\":\"{\\\"id\\\":\\\"14\\\",\\\"name\\\":\\\"zipPartitions\\\"}\",\"Callsite\":\"zipPartitions at VertexRDDImpl.scala:144\",\"Parent IDs\":[12,16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"VertexRDD, VertexRDD\",\"Scope\":\"{\\\"id\\\":\\\"10\\\",\\\"name\\\":\\\"mapPartitions\\\"}\",\"Callsite\":\"mapPartitions at VertexRDD.scala:345\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"VertexRDD\",\"Scope\":\"{\\\"id\\\":\\\"13\\\",\\\"name\\\":\\\"mapPartitions\\\"}\",\"Callsite\":\"mapPartitions at VertexRDDImpl.scala:96\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":true,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"VertexRDD\",\"Scope\":\"{\\\"id\\\":\\\"11\\\",\\\"name\\\":\\\"mapPartitions\\\"}\",\"Callsite\":\"mapPartitions at VertexRDDImpl.scala:96\",\"Parent IDs\":[9],\"Storage Level\":{\"Use Disk\":true,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"9\\\",\\\"name\\\":\\\"mapPartitions\\\"}\",\"Callsite\":\"mapPartitions at VertexRDD.scala:361\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":7,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"8\\\",\\\"name\\\":\\\"partitionBy\\\"}\",\"Callsite\":\"partitionBy at VertexRDD.scala:361\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[1],\"Details\":\"org.apache.spark.rdd.RDD.mapPartitions(RDD.scala:819)\\norg.apache.spark.graphx.impl.VertexRDDImpl.shipVertexAttributes(VertexRDDImpl.scala:247)\\norg.apache.spark.graphx.impl.ReplicatedVertexView.updateVertices(ReplicatedVertexView.scala:107)\\norg.apache.spark.graphx.impl.GraphImpl.mapVertices(GraphImpl.scala:133)\\norg.apache.spark.graphx.Pregel$.apply(Pregel.scala:130)\\norg.apache.spark.graphx.lib.ShortestPaths$.run(ShortestPaths.scala:71)\\nsrc.main.scala.ShortestPathsApp$.main(ShortestPathsApp.scala:71)\\nsrc.main.scala.ShortestPathsApp.main(ShortestPathsApp.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.JavaMainApplication.start(SparkApplication.scala:52)\\norg.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:845)\\norg.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:161)\\norg.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:184)\\norg.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:86)\\norg.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:920)\\norg.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:929)\\norg.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)\",\"Accumulables\":[]},{\"Stage ID\":3,\"Stage Attempt ID\":0,\"Stage Name\":\"mapPartitions at VertexRDDImpl.scala:247\",\"Number of Tasks\":10,\"RDD Info\":[{\"RDD ID\":24,\"Name\":\"ReplicatedVertexView.upgrade(true, true) - shippedVerts true true (broadcast)\",\"Scope\":\"{\\\"id\\\":\\\"18\\\",\\\"name\\\":\\\"mapPartitions\\\"}\",\"Callsite\":\"mapPartitions at VertexRDDImpl.scala:247\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"VertexRDD, VertexRDD\",\"Scope\":\"{\\\"id\\\":\\\"10\\\",\\\"name\\\":\\\"mapPartitions\\\"}\",\"Callsite\":\"mapPartitions at VertexRDD.scala:345\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"VertexRDD\",\"Scope\":\"{\\\"id\\\":\\\"13\\\",\\\"name\\\":\\\"mapPartitions\\\"}\",\"Callsite\":\"mapPartitions at VertexRDDImpl.scala:96\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":true,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"VertexRDD\",\"Scope\":\"{\\\"id\\\":\\\"11\\\",\\\"name\\\":\\\"mapPartitions\\\"}\",\"Callsite\":\"mapPartitions at VertexRDDImpl.scala:96\",\"Parent IDs\":[9],\"Storage Level\":{\"Use Disk\":true,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"9\\\",\\\"name\\\":\\\"mapPartitions\\\"}\",\"Callsite\":\"mapPartitions at VertexRDD.scala:361\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":7,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"8\\\",\\\"name\\\":\\\"partitionBy\\\"}\",\"Callsite\":\"partitionBy at VertexRDD.scala:361\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[1],\"Details\":\"org.apache.spark.rdd.RDD.mapPartitions(RDD.scala:819)\\norg.apache.spark.graphx.impl.VertexRDDImpl.shipVertexAttributes(VertexRDDImpl.scala:247)\\norg.apache.spark.graphx.impl.ReplicatedVertexView.upgrade(ReplicatedVertexView.scala:66)\\norg.apache.spark.graphx.impl.GraphImpl.aggregateMessagesWithActiveSet(GraphImpl.scala:198)\\norg.apache.spark.graphx.GraphXUtils$.mapReduceTriplets(GraphXUtils.scala:69)\\norg.apache.spark.graphx.Pregel$.apply(Pregel.scala:136)\\norg.apache.spark.graphx.lib.ShortestPaths$.run(ShortestPaths.scala:71)\\nsrc.main.scala.ShortestPathsApp$.main(ShortestPathsApp.scala:71)\\nsrc.main.scala.ShortestPathsApp.main(ShortestPathsApp.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.JavaMainApplication.start(SparkApplication.scala:52)\\norg.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:845)\\norg.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:161)\\norg.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:184)\\norg.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:86)\\norg.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:920)\\norg.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:929)\",\"Accumulables\":[]},{\"Stage ID\":4,\"Stage Attempt ID\":0,\"Stage Name\":\"mapPartitions at GraphImpl.scala:208\",\"Number of Tasks\":10,\"RDD Info\":[{\"RDD ID\":28,\"Name\":\"GraphImpl.aggregateMessages - preAgg\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"mapPartitions\\\"}\",\"Callsite\":\"mapPartitions at GraphImpl.scala:208\",\"Parent IDs\":[26],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":25,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"partitionBy\\\"}\",\"Callsite\":\"partitionBy at ReplicatedVertexView.scala:69\",\"Parent IDs\":[24],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":21,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"16\\\",\\\"name\\\":\\\"partitionBy\\\"}\",\"Callsite\":\"partitionBy at ReplicatedVertexView.scala:110\",\"Parent IDs\":[20],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"hdfs://node1:9000/SparkBench/ShortestPaths/Input\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"textFile\\\"}\",\"Callsite\":\"textFile at GraphLoader.scala:71\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":13,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"EdgeRDD\",\"Scope\":\"{\\\"id\\\":\\\"12\\\",\\\"name\\\":\\\"mapPartitions\\\"}\",\"Callsite\":\"mapPartitions at EdgeRDDImpl.scala:119\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":true,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":1,\"Name\":\"hdfs://node1:9000/SparkBench/ShortestPaths/Input\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"textFile\\\"}\",\"Callsite\":\"textFile at GraphLoader.scala:71\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":13,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoalescedRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"coalesce\\\"}\",\"Callsite\":\"coalesce at GraphLoader.scala:71\",\"Parent IDs\":[1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":22,\"Name\":\"EdgeRDD\",\"Scope\":\"{\\\"id\\\":\\\"17\\\",\\\"name\\\":\\\"zipPartitions\\\"}\",\"Callsite\":\"zipPartitions at ReplicatedVertexView.scala:112\",\"Parent IDs\":[14,21],\"Storage Level\":{\"Use Disk\":true,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":26,\"Name\":\"EdgeRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"zipPartitions\\\"}\",\"Callsite\":\"zipPartitions at ReplicatedVertexView.scala:70\",\"Parent IDs\":[22,25],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"GraphLoader.edgeListFile - edges (hdfs://node1:9000/SparkBench/ShortestPaths/Input), EdgeRDD, EdgeRDD\",\"Scope\":\"{\\\"id\\\":\\\"2\\\",\\\"name\\\":\\\"mapPartitionsWithIndex\\\"}\",\"Callsite\":\"mapPartitionsWithIndex at GraphLoader.scala:75\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":true,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[2,3],\"Details\":\"org.apache.spark.rdd.RDD.mapPartitions(RDD.scala:819)\\norg.apache.spark.graphx.impl.GraphImpl.aggregateMessagesWithActiveSet(GraphImpl.scala:208)\\norg.apache.spark.graphx.GraphXUtils$.mapReduceTriplets(GraphXUtils.scala:69)\\norg.apache.spark.graphx.Pregel$.apply(Pregel.scala:136)\\norg.apache.spark.graphx.lib.ShortestPaths$.run(ShortestPaths.scala:71)\\nsrc.main.scala.ShortestPathsApp$.main(ShortestPathsApp.scala:71)\\nsrc.main.scala.ShortestPathsApp.main(ShortestPathsApp.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.JavaMainApplication.start(SparkApplication.scala:52)\\norg.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:845)\\norg.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:161)\\norg.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:184)\\norg.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:86)\\norg.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:920)\\norg.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:929)\\norg.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)\",\"Accumulables\":[]}],\"Stage IDs\":[1,5,2,3,4],\"Properties\":{\"spark.rdd.scope.noOverride\":\"true\",\"spark.rdd.scope\":\"{\\\"id\\\":\\\"25\\\",\\\"name\\\":\\\"fold\\\"}\"}}\n").
                    toJavaObject(JobStartEvent.class);
            JobStartEvent jse2 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":2,\"Submission Time\":1638155546057,\"Stage Infos\":[{\"Stage ID\":6,\"Stage Attempt ID\":0,\"Stage Name\":\"mapPartitions at VertexRDD.scala:356\",\"Number of Tasks\":10,\"RDD Info\":[{\"RDD ID\":6,\"Name\":\"VertexRDD.createRoutingTables - vid2pid (aggregation)\",\"Scope\":\"{\\\"id\\\":\\\"7\\\",\\\"name\\\":\\\"mapPartitions\\\"}\",\"Callsite\":\"mapPartitions at VertexRDD.scala:356\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"hdfs://node1:9000/SparkBench/ShortestPaths/Input\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"textFile\\\"}\",\"Callsite\":\"textFile at GraphLoader.scala:71\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":13,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":1,\"Name\":\"hdfs://node1:9000/SparkBench/ShortestPaths/Input\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"textFile\\\"}\",\"Callsite\":\"textFile at GraphLoader.scala:71\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":13,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoalescedRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"coalesce\\\"}\",\"Callsite\":\"coalesce at GraphLoader.scala:71\",\"Parent IDs\":[1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"GraphLoader.edgeListFile - edges (hdfs://node1:9000/SparkBench/ShortestPaths/Input), EdgeRDD, EdgeRDD\",\"Scope\":\"{\\\"id\\\":\\\"2\\\",\\\"name\\\":\\\"mapPartitionsWithIndex\\\"}\",\"Callsite\":\"mapPartitionsWithIndex at GraphLoader.scala:75\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":true,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.mapPartitions(RDD.scala:819)\\norg.apache.spark.graphx.VertexRDD$.createRoutingTables(VertexRDD.scala:356)\\norg.apache.spark.graphx.VertexRDD$.fromEdges(VertexRDD.scala:344)\\norg.apache.spark.graphx.impl.GraphImpl$.fromEdgeRDD(GraphImpl.scala:361)\\norg.apache.spark.graphx.impl.GraphImpl$.fromEdgePartitions(GraphImpl.scala:300)\\norg.apache.spark.graphx.GraphLoader$.edgeListFile(GraphLoader.scala:98)\\nsrc.main.scala.ShortestPathsApp$.main(ShortestPathsApp.scala:56)\\nsrc.main.scala.ShortestPathsApp.main(ShortestPathsApp.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.JavaMainApplication.start(SparkApplication.scala:52)\\norg.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:845)\\norg.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:161)\\norg.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:184)\\norg.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:86)\\norg.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:920)\\norg.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:929)\\norg.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)\",\"Accumulables\":[]},{\"Stage ID\":7,\"Stage Attempt ID\":0,\"Stage Name\":\"runJob at SparkHadoopWriter.scala:78\",\"Number of Tasks\":10,\"RDD Info\":[{\"RDD ID\":33,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"49\\\",\\\"name\\\":\\\"saveAsTextFile\\\"}\",\"Callsite\":\"saveAsTextFile at ShortestPathsApp.scala:73\",\"Parent IDs\":[17],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":17,\"Name\":\"VertexRDDImpl\",\"Callsite\":\"RDD at VertexRDD.scala:57\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":true,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"VertexRDD, VertexRDD\",\"Scope\":\"{\\\"id\\\":\\\"10\\\",\\\"name\\\":\\\"mapPartitions\\\"}\",\"Callsite\":\"mapPartitions at VertexRDD.scala:345\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"VertexRDD\",\"Scope\":\"{\\\"id\\\":\\\"13\\\",\\\"name\\\":\\\"mapPartitions\\\"}\",\"Callsite\":\"mapPartitions at VertexRDDImpl.scala:96\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":true,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"VertexRDD\",\"Scope\":\"{\\\"id\\\":\\\"11\\\",\\\"name\\\":\\\"mapPartitions\\\"}\",\"Callsite\":\"mapPartitions at VertexRDDImpl.scala:96\",\"Parent IDs\":[9],\"Storage Level\":{\"Use Disk\":true,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"9\\\",\\\"name\\\":\\\"mapPartitions\\\"}\",\"Callsite\":\"mapPartitions at VertexRDD.scala:361\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":7,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"8\\\",\\\"name\\\":\\\"partitionBy\\\"}\",\"Callsite\":\"partitionBy at VertexRDD.scala:361\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":10,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[6],\"Details\":\"org.apache.spark.SparkContext.runJob(SparkContext.scala:2114)\\norg.apache.spark.internal.io.SparkHadoopWriter$.write(SparkHadoopWriter.scala:78)\\norg.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopDataset$1.apply$mcV$sp(PairRDDFunctions.scala:1096)\\norg.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopDataset$1.apply(PairRDDFunctions.scala:1094)\\norg.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopDataset$1.apply(PairRDDFunctions.scala:1094)\\norg.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\\norg.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\\norg.apache.spark.rdd.RDD.withScope(RDD.scala:385)\\norg.apache.spark.rdd.PairRDDFunctions.saveAsHadoopDataset(PairRDDFunctions.scala:1094)\\norg.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopFile$4.apply$mcV$sp(PairRDDFunctions.scala:1067)\\norg.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopFile$4.apply(PairRDDFunctions.scala:1032)\\norg.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopFile$4.apply(PairRDDFunctions.scala:1032)\\norg.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\\norg.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\\norg.apache.spark.rdd.RDD.withScope(RDD.scala:385)\\norg.apache.spark.rdd.PairRDDFunctions.saveAsHadoopFile(PairRDDFunctions.scala:1032)\\norg.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopFile$1.apply$mcV$sp(PairRDDFunctions.scala:958)\\norg.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopFile$1.apply(PairRDDFunctions.scala:958)\\norg.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopFile$1.apply(PairRDDFunctions.scala:958)\\norg.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\",\"Accumulables\":[]}],\"Stage IDs\":[6,7],\"Properties\":{\"spark.rdd.scope.noOverride\":\"true\",\"spark.rdd.scope\":\"{\\\"id\\\":\\\"49\\\",\\\"name\\\":\\\"saveAsTextFile\\\"}\"}}\n").
                    toJavaObject(JobStartEvent.class);
            List<JobStartEvent> jobs = new ArrayList<>();
            jobs.add(jse0);
            jobs.add(jse1);
            jobs.add(jse2);
            int[][] simpleDAG = CacheSketcher.generateSimpleDAGByJobsAndStages(jobs, new ArrayList<>());
            int arrSize = 34, actionSize = 3;
            assertEquals(arrSize + actionSize, simpleDAG.length);
            List<Integer> biggerThanZero = new ArrayList<>();
            List<Integer> ghostRDD = new ArrayList<>();
            for(int i = 0; i < arrSize; i++) {
                int sum = 0;
                for(int j = 0; j < arrSize + actionSize; j++) {
                    if(simpleDAG[i][j] > 0) {
                        sum += 1;
                    }
                }
                System.out.println("rdd: " + i + ", pure ref: " + sum);
                if(sum > 1) {
                    biggerThanZero.add(i);
                }else if(sum == 0) {
                    ghostRDD.add(i);
                }
            }
            System.out.println("hot data: " + biggerThanZero);
            int[] contrastArr = {3, 12, 16};
            assertEquals(contrastArr.length, biggerThanZero.size());
            for(int i = 0; i < contrastArr.length; i++) {
                assertEquals(contrastArr[i], biggerThanZero.get(i));
            }
            int[] ghostContrast = {4, 5, 10, 11, 13, 15, 19, 23, 27, 31};
            assertEquals(ghostContrast.length, ghostRDD.size());
            for(int i = 0; i < ghostContrast.length; i++) {
                assertEquals(ghostContrast[i], ghostRDD.get(i));
            }
        }
    }

    @Test
    void testGenerateStageHitValue() throws IOException {
        JobStartEvent jse0 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":0,\"Submission Time\":1636630209838,\"Stage Infos\":[{\"Stage ID\":0,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:62\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:62)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[0],\"Properties\":{}}\n")
                .toJavaObject(JobStartEvent.class);
        JobStartEvent jse1 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":1,\"Submission Time\":1636630210525,\"Stage Infos\":[{\"Stage ID\":1,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":2,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":3,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[1,2],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":4,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[3],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[1,2,3,4],\"Properties\":{}}\n")
                .toJavaObject(JobStartEvent.class);
        JobStartEvent jse2 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":2,\"Submission Time\":1636630211337,\"Stage Infos\":[{\"Stage ID\":9,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[7],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":5,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":6,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":10,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[9,7,8],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":7,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[5,6],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":11,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[10],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":8,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[9,5,6,10,7,11,8],\"Properties\":{}}\n")
                .toJavaObject(JobStartEvent.class);
        JobStartEvent jse3 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":3,\"Submission Time\":1636630211585,\"Stage Infos\":[{\"Stage ID\":15,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":12,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":16,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":13,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":17,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[15,16,14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":18,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:76\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[17],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:76)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":14,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[12,13],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[15,12,16,13,17,18,14],\"Properties\":{}}\n")
                .toJavaObject(JobStartEvent.class);
        List<JobStartEvent> jobs = new ArrayList<>();
        jobs.add(jse0);
        jobs.add(jse1);
        jobs.add(jse2);
        jobs.add(jse3);
        StageCompletedEvent sce0 = JSON.parseObject("{\"Event\":\"SparkListenerStageCompleted\",\"Stage Info\":{\"Stage ID\":0,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:62\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:62)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Submission Time\":1636630209870,\"Completion Time\":1636630210434,\"Accumulables\":[{\"ID\":2,\"Name\":\"internal.metrics.executorRunTime\",\"Value\":72,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":4,\"Name\":\"internal.metrics.resultSize\",\"Value\":789,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":1,\"Name\":\"internal.metrics.executorDeserializeCpuTime\",\"Value\":159975753,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":3,\"Name\":\"internal.metrics.executorCpuTime\",\"Value\":60086427,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":6,\"Name\":\"internal.metrics.resultSerializationTime\",\"Value\":1,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":0,\"Name\":\"internal.metrics.executorDeserializeTime\",\"Value\":233,\"Internal\":true,\"Count Failed Values\":true}]}}\n")
                .toJavaObject(StageCompletedEvent.class);
        StageCompletedEvent sce1 = JSON.parseObject("{\"Event\":\"SparkListenerStageCompleted\",\"Stage Info\":{\"Stage ID\":1,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Submission Time\":1636630210535,\"Completion Time\":1636630210632,\"Accumulables\":[{\"ID\":44,\"Name\":\"internal.metrics.shuffle.write.recordsWritten\",\"Value\":200,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":26,\"Name\":\"internal.metrics.executorDeserializeCpuTime\",\"Value\":15375114,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":47,\"Name\":\"internal.metrics.input.recordsRead\",\"Value\":200,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":29,\"Name\":\"internal.metrics.resultSize\",\"Value\":1012,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":46,\"Name\":\"internal.metrics.input.bytesRead\",\"Value\":7216,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":31,\"Name\":\"internal.metrics.resultSerializationTime\",\"Value\":1,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":43,\"Name\":\"internal.metrics.shuffle.write.bytesWritten\",\"Value\":1504,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":25,\"Name\":\"internal.metrics.executorDeserializeTime\",\"Value\":25,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":28,\"Name\":\"internal.metrics.executorCpuTime\",\"Value\":19521626,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":45,\"Name\":\"internal.metrics.shuffle.write.writeTime\",\"Value\":5487950,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":27,\"Name\":\"internal.metrics.executorRunTime\",\"Value\":21,\"Internal\":true,\"Count Failed Values\":true}]}}\n")
                .toJavaObject(StageCompletedEvent.class);
        StageCompletedEvent sce2 = JSON.parseObject("{\"Event\":\"SparkListenerStageCompleted\",\"Stage Info\":{\"Stage ID\":2,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Submission Time\":1636630210563,\"Completion Time\":1636630210669,\"Accumulables\":[{\"ID\":68,\"Name\":\"internal.metrics.shuffle.write.bytesWritten\",\"Value\":1495,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":50,\"Name\":\"internal.metrics.executorDeserializeTime\",\"Value\":26,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":71,\"Name\":\"internal.metrics.input.bytesRead\",\"Value\":7216,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":53,\"Name\":\"internal.metrics.executorCpuTime\",\"Value\":6041561,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":70,\"Name\":\"internal.metrics.shuffle.write.writeTime\",\"Value\":653409,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":52,\"Name\":\"internal.metrics.executorRunTime\",\"Value\":7,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":69,\"Name\":\"internal.metrics.shuffle.write.recordsWritten\",\"Value\":200,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":72,\"Name\":\"internal.metrics.input.recordsRead\",\"Value\":200,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":54,\"Name\":\"internal.metrics.resultSize\",\"Value\":969,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":51,\"Name\":\"internal.metrics.executorDeserializeCpuTime\",\"Value\":12733333,\"Internal\":true,\"Count Failed Values\":true}]}}\n")
                .toJavaObject(StageCompletedEvent.class);
        StageCompletedEvent sce3 = JSON.parseObject("{\"Event\":\"SparkListenerStageCompleted\",\"Stage Info\":{\"Stage ID\":3,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[1,2],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Submission Time\":1636630210675,\"Completion Time\":1636630211154,\"Accumulables\":[{\"ID\":92,\"Name\":\"internal.metrics.shuffle.read.recordsRead\",\"Value\":400,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":83,\"Name\":\"internal.metrics.diskBytesSpilled\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":95,\"Name\":\"internal.metrics.shuffle.write.writeTime\",\"Value\":1556842,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":86,\"Name\":\"internal.metrics.shuffle.read.remoteBlocksFetched\",\"Value\":2,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":77,\"Name\":\"internal.metrics.executorRunTime\",\"Value\":261,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":89,\"Name\":\"internal.metrics.shuffle.read.remoteBytesReadToDisk\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":91,\"Name\":\"internal.metrics.shuffle.read.fetchWaitTime\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":82,\"Name\":\"internal.metrics.memoryBytesSpilled\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":94,\"Name\":\"internal.metrics.shuffle.write.recordsWritten\",\"Value\":644,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":76,\"Name\":\"internal.metrics.executorDeserializeCpuTime\",\"Value\":185437207,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":88,\"Name\":\"internal.metrics.shuffle.read.remoteBytesRead\",\"Value\":2999,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":97,\"Name\":\"internal.metrics.input.recordsRead\",\"Value\":200,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":79,\"Name\":\"internal.metrics.resultSize\",\"Value\":2456,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":87,\"Name\":\"internal.metrics.shuffle.read.localBlocksFetched\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":96,\"Name\":\"internal.metrics.input.bytesRead\",\"Value\":7216,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":78,\"Name\":\"internal.metrics.executorCpuTime\",\"Value\":237899438,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":90,\"Name\":\"internal.metrics.shuffle.read.localBytesRead\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":81,\"Name\":\"internal.metrics.resultSerializationTime\",\"Value\":1,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":75,\"Name\":\"internal.metrics.executorDeserializeTime\",\"Value\":239,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":84,\"Name\":\"internal.metrics.peakExecutionMemory\",\"Value\":71356,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":93,\"Name\":\"internal.metrics.shuffle.write.bytesWritten\",\"Value\":4778,\"Internal\":true,\"Count Failed Values\":true}]}}\n").
                toJavaObject(StageCompletedEvent.class);
        StageCompletedEvent sce4 = JSON.parseObject("{\"Event\":\"SparkListenerStageCompleted\",\"Stage Info\":{\"Stage ID\":4,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[3],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Submission Time\":1636630211165,\"Completion Time\":1636630211303,\"Accumulables\":[{\"ID\":101,\"Name\":\"internal.metrics.executorDeserializeCpuTime\",\"Value\":26895281,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":104,\"Name\":\"internal.metrics.resultSize\",\"Value\":2395,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":113,\"Name\":\"internal.metrics.shuffle.read.remoteBytesRead\",\"Value\":2213,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":116,\"Name\":\"internal.metrics.shuffle.read.fetchWaitTime\",\"Value\":17,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":107,\"Name\":\"internal.metrics.memoryBytesSpilled\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":106,\"Name\":\"internal.metrics.resultSerializationTime\",\"Value\":1,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":115,\"Name\":\"internal.metrics.shuffle.read.localBytesRead\",\"Value\":2565,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":100,\"Name\":\"internal.metrics.executorDeserializeTime\",\"Value\":53,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":109,\"Name\":\"internal.metrics.peakExecutionMemory\",\"Value\":29888,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":103,\"Name\":\"internal.metrics.executorCpuTime\",\"Value\":97836070,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":112,\"Name\":\"internal.metrics.shuffle.read.localBlocksFetched\",\"Value\":2,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":114,\"Name\":\"internal.metrics.shuffle.read.remoteBytesReadToDisk\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":117,\"Name\":\"internal.metrics.shuffle.read.recordsRead\",\"Value\":644,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":108,\"Name\":\"internal.metrics.diskBytesSpilled\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":102,\"Name\":\"internal.metrics.executorRunTime\",\"Value\":133,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":111,\"Name\":\"internal.metrics.shuffle.read.remoteBlocksFetched\",\"Value\":2,\"Internal\":true,\"Count Failed Values\":true}]}}\n")
                .toJavaObject(StageCompletedEvent.class);
        StageCompletedEvent sce8 = JSON.parseObject("{\"Event\":\"SparkListenerStageCompleted\",\"Stage Info\":{\"Stage ID\":8,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Submission Time\":1636630211341,\"Completion Time\":1636630211383,\"Accumulables\":[{\"ID\":146,\"Name\":\"internal.metrics.input.bytesRead\",\"Value\":7216,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":128,\"Name\":\"internal.metrics.executorCpuTime\",\"Value\":3743816,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":125,\"Name\":\"internal.metrics.executorDeserializeTime\",\"Value\":16,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":145,\"Name\":\"internal.metrics.shuffle.write.writeTime\",\"Value\":963450,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":127,\"Name\":\"internal.metrics.executorRunTime\",\"Value\":4,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":147,\"Name\":\"internal.metrics.input.recordsRead\",\"Value\":200,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":129,\"Name\":\"internal.metrics.resultSize\",\"Value\":970,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":144,\"Name\":\"internal.metrics.shuffle.write.recordsWritten\",\"Value\":200,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":126,\"Name\":\"internal.metrics.executorDeserializeCpuTime\",\"Value\":6626278,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":143,\"Name\":\"internal.metrics.shuffle.write.bytesWritten\",\"Value\":1711,\"Internal\":true,\"Count Failed Values\":true}]}}\n")
                .toJavaObject(StageCompletedEvent.class);
        StageCompletedEvent sce9 = JSON.parseObject("{\"Event\":\"SparkListenerStageCompleted\",\"Stage Info\":{\"Stage ID\":9,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[7],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Submission Time\":1636630211355,\"Completion Time\":1636630211409,\"Accumulables\":[{\"ID\":169,\"Name\":\"internal.metrics.shuffle.write.recordsWritten\",\"Value\":633,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":151,\"Name\":\"internal.metrics.executorDeserializeCpuTime\",\"Value\":14816378,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":172,\"Name\":\"internal.metrics.input.recordsRead\",\"Value\":633,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":154,\"Name\":\"internal.metrics.resultSize\",\"Value\":1940,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":168,\"Name\":\"internal.metrics.shuffle.write.bytesWritten\",\"Value\":4870,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":150,\"Name\":\"internal.metrics.executorDeserializeTime\",\"Value\":31,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":171,\"Name\":\"internal.metrics.input.bytesRead\",\"Value\":22824,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":153,\"Name\":\"internal.metrics.executorCpuTime\",\"Value\":12597439,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":170,\"Name\":\"internal.metrics.shuffle.write.writeTime\",\"Value\":4875632,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":152,\"Name\":\"internal.metrics.executorRunTime\",\"Value\":12,\"Internal\":true,\"Count Failed Values\":true}]}}\n")
                .toJavaObject(StageCompletedEvent.class);
        StageCompletedEvent sce10 = JSON.parseObject("{\"Event\":\"SparkListenerStageCompleted\",\"Stage Info\":{\"Stage ID\":10,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[9,7,8],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Submission Time\":1636630211412,\"Completion Time\":1636630211505,\"Accumulables\":[{\"ID\":191,\"Name\":\"internal.metrics.shuffle.read.fetchWaitTime\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":182,\"Name\":\"internal.metrics.memoryBytesSpilled\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":176,\"Name\":\"internal.metrics.executorDeserializeCpuTime\",\"Value\":15984192,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":194,\"Name\":\"internal.metrics.shuffle.write.recordsWritten\",\"Value\":1977,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":175,\"Name\":\"internal.metrics.executorDeserializeTime\",\"Value\":31,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":184,\"Name\":\"internal.metrics.peakExecutionMemory\",\"Value\":159444,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":193,\"Name\":\"internal.metrics.shuffle.write.bytesWritten\",\"Value\":14410,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":187,\"Name\":\"internal.metrics.shuffle.read.localBlocksFetched\",\"Value\":3,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":178,\"Name\":\"internal.metrics.executorCpuTime\",\"Value\":75756569,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":196,\"Name\":\"internal.metrics.input.bytesRead\",\"Value\":22824,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":190,\"Name\":\"internal.metrics.shuffle.read.localBytesRead\",\"Value\":3321,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":189,\"Name\":\"internal.metrics.shuffle.read.remoteBytesReadToDisk\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":183,\"Name\":\"internal.metrics.diskBytesSpilled\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":192,\"Name\":\"internal.metrics.shuffle.read.recordsRead\",\"Value\":833,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":186,\"Name\":\"internal.metrics.shuffle.read.remoteBlocksFetched\",\"Value\":3,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":177,\"Name\":\"internal.metrics.executorRunTime\",\"Value\":95,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":195,\"Name\":\"internal.metrics.shuffle.write.writeTime\",\"Value\":778310,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":188,\"Name\":\"internal.metrics.shuffle.read.remoteBytesRead\",\"Value\":3260,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":179,\"Name\":\"internal.metrics.resultSize\",\"Value\":4834,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":197,\"Name\":\"internal.metrics.input.recordsRead\",\"Value\":633,\"Internal\":true,\"Count Failed Values\":true}]}}\n")
                .toJavaObject(StageCompletedEvent.class);
        StageCompletedEvent sce11 = JSON.parseObject("{\"Event\":\"SparkListenerStageCompleted\",\"Stage Info\":{\"Stage ID\":11,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[10],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Submission Time\":1636630211508,\"Completion Time\":1636630211576,\"Accumulables\":[{\"ID\":200,\"Name\":\"internal.metrics.executorDeserializeTime\",\"Value\":27,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":209,\"Name\":\"internal.metrics.peakExecutionMemory\",\"Value\":67475,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":202,\"Name\":\"internal.metrics.executorRunTime\",\"Value\":71,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":211,\"Name\":\"internal.metrics.shuffle.read.remoteBlocksFetched\",\"Value\":8,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":214,\"Name\":\"internal.metrics.shuffle.read.remoteBytesReadToDisk\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":217,\"Name\":\"internal.metrics.shuffle.read.recordsRead\",\"Value\":1977,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":208,\"Name\":\"internal.metrics.diskBytesSpilled\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":216,\"Name\":\"internal.metrics.shuffle.read.fetchWaitTime\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":207,\"Name\":\"internal.metrics.memoryBytesSpilled\",\"Value\":0,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":201,\"Name\":\"internal.metrics.executorDeserializeCpuTime\",\"Value\":14164169,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":213,\"Name\":\"internal.metrics.shuffle.read.remoteBytesRead\",\"Value\":9487,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":204,\"Name\":\"internal.metrics.resultSize\",\"Value\":4704,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":203,\"Name\":\"internal.metrics.executorCpuTime\",\"Value\":52903614,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":212,\"Name\":\"internal.metrics.shuffle.read.localBlocksFetched\",\"Value\":4,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":215,\"Name\":\"internal.metrics.shuffle.read.localBytesRead\",\"Value\":4923,\"Internal\":true,\"Count Failed Values\":true}]}}\n")
                .toJavaObject(StageCompletedEvent.class);
        StageCompletedEvent sce18 = JSON.parseObject("{\"Event\":\"SparkListenerStageCompleted\",\"Stage Info\":{\"Stage ID\":18,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:76\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[17],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:76)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Submission Time\":1636630211587,\"Completion Time\":1636630211643,\"Accumulables\":[{\"ID\":227,\"Name\":\"internal.metrics.executorRunTime\",\"Value\":3,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":226,\"Name\":\"internal.metrics.executorDeserializeCpuTime\",\"Value\":12773473,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":247,\"Name\":\"internal.metrics.input.recordsRead\",\"Value\":1427,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":229,\"Name\":\"internal.metrics.resultSize\",\"Value\":3285,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":225,\"Name\":\"internal.metrics.executorDeserializeTime\",\"Value\":26,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":246,\"Name\":\"internal.metrics.input.bytesRead\",\"Value\":51448,\"Internal\":true,\"Count Failed Values\":true},{\"ID\":228,\"Name\":\"internal.metrics.executorCpuTime\",\"Value\":3382306,\"Internal\":true,\"Count Failed Values\":true}]}}\n")
                .toJavaObject(StageCompletedEvent.class);
        StageCompletedEvent[] sces = {sce0, sce1, sce2, sce3, sce4, sce8, sce9, sce10, sce11, sce18};
        List<StageCompletedEvent> stages = new ArrayList<>(Arrays.asList(sces));
        int[][] simpleDAG = CacheSketcher.generateSimpleDAGByJobsAndStages(jobs, stages);
        List<Long> biggerThanZero = new ArrayList<>();
        for(int i = 0; i < 18; i++) {
            int sum = 0;
            for(int j = 0; j < 22; j++) {
                if(simpleDAG[i][j] > 0) {
                    sum += 1;
                }
            }
            if(sum > 1) {
                biggerThanZero.add((long)i);
            }
        }
        {
            // stage hit num with stages
            int num = CacheSketcher.generateStageHitNumWithStagesV0(stages, biggerThanZero);
            System.out.println("hit stage num: " + num);
            assertEquals(10, num);
        }
        {
            // stage hit ratio with jobs
            double ratio = CacheSketcher.generateStageHitRatioWithJobs(jobs, biggerThanZero);
            System.out.println("hit stage ratio: " + ratio);
            assertEquals(1, ratio);
        }
    }

    @Test
    void testGenerate0IndegreeRDDPerJob() {
        {
            Stage stage = new Stage();
            stage.rdds = new ArrayList<>();
            RDD[] rdds = new RDD[14];
            for(int i = 1; i < rdds.length; i++) {
                rdds[i] = new RDD();
                rdds[i].rddId = (long) i;
                rdds[i].rddParentIDs = new ArrayList<>();
                rdds[i].partitionNum = (long) i;
                stage.rdds.add(rdds[i]);
            }
            rdds[1].rddParentIDs.add(4L);
            rdds[1].rddParentIDs.add(5L);
            rdds[2].rddParentIDs.add(6L);
            rdds[2].rddParentIDs.add(7L);
            rdds[3].rddParentIDs.add(8L);
            rdds[3].rddParentIDs.add(9L);
            rdds[10].rddParentIDs.add(1L);
            rdds[11].rddParentIDs.add(1L);
            rdds[11].rddParentIDs.add(2L);
            rdds[12].rddParentIDs.add(2L);
            rdds[12].rddParentIDs.add(3L);
            rdds[13].rddParentIDs.add(3L);
            JobStartEvent jse = new JobStartEvent();
            jse.stages = new ArrayList<>();
            jse.stages.add(stage);
            Set<Long> zeroIndegree = CacheSketcher.generate0IndegreeRDDPerJob(jse);
            assertEquals(zeroIndegree.size(), 6);
            assertTrue(zeroIndegree.contains(4L));
            assertTrue(zeroIndegree.contains(5L));
            assertTrue(zeroIndegree.contains(6L));
            assertTrue(zeroIndegree.contains(7L));
            assertTrue(zeroIndegree.contains(8L));
            assertTrue(zeroIndegree.contains(9L));
        }
        {
            JobStartEvent jse = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":2,\"Submission Time\":1636630211337,\"Stage Infos\":[{\"Stage ID\":9,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[7],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":5,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":6,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":10,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[9,7,8],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":7,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[5,6],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":11,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[10],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":8,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[9,5,6,10,7,11,8],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            Set<Long> zeroIndegree = CacheSketcher.generate0IndegreeRDDPerJob(jse);
            assertEquals(1, zeroIndegree.size());
            assertTrue(zeroIndegree.contains(0L));
        }
    }

    @Test
    void testGenerate0OutdegreeRDDPerJob() {
        {
            Stage stage = new Stage();
            stage.rdds = new ArrayList<>();
            RDD[] rdds = new RDD[14];
            for(int i = 1; i < rdds.length; i++) {
                rdds[i] = new RDD();
                rdds[i].rddId = (long) i;
                rdds[i].rddParentIDs = new ArrayList<>();
                rdds[i].partitionNum = (long) i;
                stage.rdds.add(rdds[i]);
            }
            rdds[1].rddParentIDs.add(4L);
            rdds[1].rddParentIDs.add(5L);
            rdds[2].rddParentIDs.add(6L);
            rdds[2].rddParentIDs.add(7L);
            rdds[3].rddParentIDs.add(8L);
            rdds[3].rddParentIDs.add(9L);
            rdds[10].rddParentIDs.add(1L);
            rdds[11].rddParentIDs.add(1L);
            rdds[11].rddParentIDs.add(2L);
            rdds[12].rddParentIDs.add(2L);
            rdds[12].rddParentIDs.add(3L);
            rdds[13].rddParentIDs.add(3L);
            JobStartEvent jse = new JobStartEvent();
            jse.stages = new ArrayList<>();
            jse.stages.add(stage);
            Map<Long, Integer> directRef = CacheSketcher.generateRDDDirectRefPerJob(jse, null);
            Set<Long> zeroOutdegreeRDD = CacheSketcher.generate0OutDegreeRDDFromDirectRef(directRef);
            assertEquals(4, zeroOutdegreeRDD.size());
            assertTrue(zeroOutdegreeRDD.contains(10L));
            assertTrue(zeroOutdegreeRDD.contains(11L));
            assertTrue(zeroOutdegreeRDD.contains(12L));
            assertTrue(zeroOutdegreeRDD.contains(13L));
        }
        {
            JobStartEvent jse = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":2,\"Submission Time\":1636630211337,\"Stage Infos\":[{\"Stage ID\":9,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[7],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":5,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":6,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":10,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[9,7,8],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":7,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[5,6],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":11,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[10],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":8,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[9,5,6,10,7,11,8],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            Map<Long, Integer> directRef = CacheSketcher.generateRDDDirectRefPerJob(jse, null);
            Set<Long> zeroOutdegreeRDD = CacheSketcher.generate0OutDegreeRDDFromDirectRef(directRef);
            assertEquals(1, zeroOutdegreeRDD.size());
            assertTrue(zeroOutdegreeRDD.contains(17L));
        }
    }

    // KEYPOINT
    @Test
    void testGenerateHopPerJob() {
        {
            // test manual job
            Stage stage = new Stage();
            stage.rdds = new ArrayList<>();
            RDD[] rdds = new RDD[14];
            for(int i = 1; i < rdds.length; i++) {
                rdds[i] = new RDD();
                rdds[i].rddId = (long) i;
                rdds[i].rddParentIDs = new ArrayList<>();
                rdds[i].partitionNum = (long) i;
                stage.rdds.add(rdds[i]);
            }
            rdds[1].rddParentIDs.add(4L);
            rdds[1].rddParentIDs.add(5L);
            rdds[2].rddParentIDs.add(6L);
            rdds[2].rddParentIDs.add(7L);
            rdds[3].rddParentIDs.add(8L);
            rdds[3].rddParentIDs.add(9L);
            rdds[10].rddParentIDs.add(1L);
            rdds[11].rddParentIDs.add(1L);
            rdds[11].rddParentIDs.add(2L);
            rdds[12].rddParentIDs.add(2L);
            rdds[12].rddParentIDs.add(3L);
            rdds[13].rddParentIDs.add(3L);
            JobStartEvent jse = new JobStartEvent();
            jse.stages = new ArrayList<>();
            jse.stages.add(stage);
            Map<Long, Integer> rddToHop = CacheSketcher.generateHopPerJob(jse);
            assertEquals(13, rddToHop.size());
            long[] key = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13};
            int[] value = {2, 2, 2, 3, 3, 3, 3, 3, 3, 1, 1, 1, 1};
            assertEquals(key.length, value.length);
            for(int i = 0; i < key.length; i++) {
                assertEquals(value[i], rddToHop.get(key[i]));
            }
        }
        {
            // test job 0
            JobStartEvent jse0 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":0,\"Submission Time\":1636630209838,\"Stage Infos\":[{\"Stage ID\":0,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:62\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:62)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[0],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            Map<Long, Integer> rddToHop = CacheSketcher.generateHopPerJob(jse0);
            int maxLen = 1;
            assertEquals(maxLen, rddToHop.size());
            int[] value = {1};
            assertEquals(maxLen, value.length);
            for(int i = 0; i < maxLen; i++) {
                assertEquals(value[i], rddToHop.get((long) i));
            }
        }
        {
            // test job 1
            JobStartEvent jse1 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":1,\"Submission Time\":1636630210525,\"Stage Infos\":[{\"Stage ID\":1,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":2,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":3,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[1,2],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":4,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[3],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[1,2,3,4],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            Map<Long, Integer> rddToHop = CacheSketcher.generateHopPerJob(jse1);
            int maxLen = 10;
            assertEquals(maxLen, rddToHop.size());
            int[] value = {10, 9, 8, 7, 6, 5, 4, 3, 2, 1};
            assertEquals(maxLen, value.length);
            for(int i = 0; i < maxLen; i++) {
                assertEquals(value[i], rddToHop.get((long) i));
            }
        }
        {
            // test job 2
            JobStartEvent jse = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":2,\"Submission Time\":1636630211337,\"Stage Infos\":[{\"Stage ID\":9,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[7],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":5,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":6,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":10,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[9,7,8],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":7,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[5,6],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":11,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[10],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":8,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[9,5,6,10,7,11,8],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            Map<Long, Integer> rddToHop = CacheSketcher.generateHopPerJob(jse);
            assertEquals(18, rddToHop.size());
            int[] value = {18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3 ,2, 1};
            assertEquals(18, value.length);
            for(int i = 0; i <= 17; i++) {
                assertEquals(value[i], rddToHop.get((long) i));
            }
        }
        {
            // test job 3
            JobStartEvent jse = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":3,\"Submission Time\":1636630211585,\"Stage Infos\":[{\"Stage ID\":15,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":12,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":16,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":13,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":17,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[15,16,14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":18,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:76\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[17],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:76)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":14,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[12,13],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[15,12,16,13,17,18,14],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            Map<Long, Integer> rddToHop = CacheSketcher.generateHopPerJob(jse);
            assertEquals(18, rddToHop.size());
            int[] value = {18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3 ,2, 1};
            assertEquals(18, value.length);
            for(int i = 0; i <= 17; i++) {
                assertEquals(value[i], rddToHop.get((long) i));
            }
        }
        {
            JobStartEvent jse0 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":0,\"Submission Time\":1636630209838,\"Stage Infos\":[{\"Stage ID\":0,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:62\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:62)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[0],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse1 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":1,\"Submission Time\":1636630210525,\"Stage Infos\":[{\"Stage ID\":1,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":2,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":3,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[1,2],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":4,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[3],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[1,2,3,4],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse2 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":2,\"Submission Time\":1636630211337,\"Stage Infos\":[{\"Stage ID\":9,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[7],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":5,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":6,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":10,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[9,7,8],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":7,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[5,6],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":11,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[10],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":8,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[9,5,6,10,7,11,8],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse3 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":3,\"Submission Time\":1636630211585,\"Stage Infos\":[{\"Stage ID\":15,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":12,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":16,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":13,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":17,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[15,16,14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":18,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:76\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[17],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:76)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":14,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[12,13],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[15,12,16,13,17,18,14],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            Map<Long, Integer> rddToHop = CacheSketcher.generateHopPerJob(jse0);
            rddToHop.putAll(CacheSketcher.generateHopPerJob(jse1));
            rddToHop.putAll(CacheSketcher.generateHopPerJob(jse2));
            rddToHop.putAll(CacheSketcher.generateHopPerJob(jse3));
            assertEquals(18, rddToHop.size());
            int[] value = {18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3 ,2, 1};
            assertEquals(18, value.length);
            for(int i = 0; i <= 17; i++) {
                assertEquals(value[i], rddToHop.get((long) i));
            }

        }
    }

    // KEYPOINT b
    @Test
    void testGenerateHopComputeTimePerJob() {
        {
            // test job 0
            JobStartEvent jse0 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":0,\"Submission Time\":1636630209838,\"Stage Infos\":[{\"Stage ID\":0,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:62\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:62)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[0],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            Map<Long, Integer> rddToHopComputeTime = CacheSketcher.generateHopComputeTimePerJob(jse0);
            int maxLen = 1;
            assertEquals(maxLen, rddToHopComputeTime.size());
            int[] value = {0};
            assertEquals(maxLen, value.length);
            for(int i = 0; i < maxLen; i++) {
                System.out.println("asserting job 0: " + i);
                assertEquals(value[i], rddToHopComputeTime.get((long) i));
            }
        }
        {
            // test job 1
            JobStartEvent jse1 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":1,\"Submission Time\":1636630210525,\"Stage Infos\":[{\"Stage ID\":1,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":2,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":3,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[1,2],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":4,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[3],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[1,2,3,4],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            Map<Long, Integer> rddToHopComputeTime = CacheSketcher.generateHopComputeTimePerJob(jse1);
            int maxLen = 10;
            assertEquals(maxLen, rddToHopComputeTime.size());
            // int[] value = {10, 9, 8, 7, 6, 5, 4, 3, 2, 1};
            int[] value = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9};
            assertEquals(maxLen, value.length);
            for(int i = 0; i < maxLen; i++) {
                System.out.println("asserting job 1: " + i);
                assertEquals(value[i], rddToHopComputeTime.get((long) i));
            }
        }
        {
            // test job 2
            JobStartEvent jse = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":2,\"Submission Time\":1636630211337,\"Stage Infos\":[{\"Stage ID\":9,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[7],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":5,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":6,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":10,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[9,7,8],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":7,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[5,6],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":11,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[10],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":8,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[9,5,6,10,7,11,8],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            Map<Long, Integer> rddToHopComputeTime = CacheSketcher.generateHopComputeTimePerJob(jse);
            int maxLen = 18;
            assertEquals(maxLen, rddToHopComputeTime.size());
            // int[] value = {18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3 ,2, 1};
            int[] value = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17};
            assertEquals(maxLen, value.length);
            for(int i = 0; i < maxLen; i++) {
                System.out.println("asserting job 2: " + i);
                assertEquals(value[i], rddToHopComputeTime.get((long) i));
            }
        }
        {
            // test job 3
            JobStartEvent jse = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":3,\"Submission Time\":1636630211585,\"Stage Infos\":[{\"Stage ID\":15,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":12,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":16,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":13,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":17,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[15,16,14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":18,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:76\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[17],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:76)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":14,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[12,13],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[15,12,16,13,17,18,14],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            Map<Long, Integer> rddToHopComputeTime = CacheSketcher.generateHopComputeTimePerJob(jse);
            int maxLen = 18;
            assertEquals(maxLen, rddToHopComputeTime.size());
            // int[] value = {18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3 ,2, 1};
            int[] value = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17};
            assertEquals(maxLen, value.length);
            for(int i = 0; i < maxLen; i++) {
                System.out.println("asserting job 3: " + i);
                assertEquals(value[i], rddToHopComputeTime.get((long) i));
            }
        }
        {
            JobStartEvent jse0 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":0,\"Submission Time\":1636630209838,\"Stage Infos\":[{\"Stage ID\":0,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:62\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:62)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[0],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse1 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":1,\"Submission Time\":1636630210525,\"Stage Infos\":[{\"Stage ID\":1,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":2,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":3,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[1,2],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":4,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[3],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[1,2,3,4],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse2 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":2,\"Submission Time\":1636630211337,\"Stage Infos\":[{\"Stage ID\":9,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[7],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":5,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":6,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":10,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[9,7,8],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":7,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[5,6],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":11,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[10],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":8,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[9,5,6,10,7,11,8],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse3 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":3,\"Submission Time\":1636630211585,\"Stage Infos\":[{\"Stage ID\":15,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":12,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":16,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":13,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":17,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[15,16,14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":18,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:76\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[17],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:76)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":14,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[12,13],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[15,12,16,13,17,18,14],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            Map<Long, Integer> rddToHopComputeTime = CacheSketcher.generateHopComputeTimePerJob(jse0);
            // 
            for(Map.Entry<Long, Integer> entry : CacheSketcher.generateHopComputeTimePerJob(jse1).entrySet()) {
                assertTrue(rddToHopComputeTime.putIfAbsent(entry.getKey(), entry.getValue()) == null ||
                        entry.getValue().equals(rddToHopComputeTime.get(entry.getKey())));
            }
            for(Map.Entry<Long, Integer> entry : CacheSketcher.generateHopComputeTimePerJob(jse2).entrySet()) {
                assertTrue(rddToHopComputeTime.putIfAbsent(entry.getKey(), entry.getValue()) == null ||
                        entry.getValue().equals(rddToHopComputeTime.get(entry.getKey())));
            }
            for(Map.Entry<Long, Integer> entry : CacheSketcher.generateHopComputeTimePerJob(jse3).entrySet()) {
                assertTrue(rddToHopComputeTime.putIfAbsent(entry.getKey(), entry.getValue()) == null ||
                        entry.getValue().equals(rddToHopComputeTime.get(entry.getKey())));
            }
            assertEquals(18, rddToHopComputeTime.size());
            int[] value = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17};
            assertEquals(18, value.length);
            for(int i = 0; i <= 17; i++) {
                assertEquals(value[i], rddToHopComputeTime.get((long) i));
            }
        }
        {
            JobStartEvent jse0 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":0,\"Submission Time\":1636630209838,\"Stage Infos\":[{\"Stage ID\":0,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:62\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:62)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[0],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse1 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":1,\"Submission Time\":1636630210525,\"Stage Infos\":[{\"Stage ID\":1,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":2,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":3,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[1,2],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":4,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[3],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[1,2,3,4],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse2 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":2,\"Submission Time\":1636630211337,\"Stage Infos\":[{\"Stage ID\":9,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[7],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":5,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":6,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":10,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[9,7,8],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":7,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[5,6],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":11,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[10],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":8,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[9,5,6,10,7,11,8],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            JobStartEvent jse3 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":3,\"Submission Time\":1636630211585,\"Stage Infos\":[{\"Stage ID\":15,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":12,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":16,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":13,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":17,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[15,16,14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":18,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:76\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[17],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:76)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":14,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[12,13],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[15,12,16,13,17,18,14],\"Properties\":{}}\n")
                    .toJavaObject(JobStartEvent.class);
            List<JobStartEvent> jobs = new ArrayList<>();
            jobs.add(jse0);
            jobs.add(jse1);
            jobs.add(jse2);
            jobs.add(jse3);
            Map<Long, Integer> rddToHopComputeTime = CacheSketcher.generateHopComputeTimeForJobs(jobs);
            assertEquals(18, rddToHopComputeTime.size());
            int[] value = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17};
            assertEquals(18, value.length);
            for(int i = 0; i <= 17; i++) {
                assertEquals(value[i], rddToHopComputeTime.get((long) i));
            }
        }
    }

    // KEYPOINT d e
    @Test
    void testGenerateCostEffectiveness() {
        JobStartEvent jse0 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":0,\"Submission Time\":1636630209838,\"Stage Infos\":[{\"Stage ID\":0,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:62\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:62)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[0],\"Properties\":{}}\n")
                .toJavaObject(JobStartEvent.class);
        JobStartEvent jse1 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":1,\"Submission Time\":1636630210525,\"Stage Infos\":[{\"Stage ID\":1,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":2,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":3,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[1,2],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":4,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[3],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[1,2,3,4],\"Properties\":{}}\n")
                .toJavaObject(JobStartEvent.class);
        JobStartEvent jse2 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":2,\"Submission Time\":1636630211337,\"Stage Infos\":[{\"Stage ID\":9,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[7],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":5,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":6,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":10,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[9,7,8],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":7,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[5,6],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":11,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:71\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[10],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:71)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":8,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[9,5,6,10,7,11,8],\"Properties\":{}}\n")
                .toJavaObject(JobStartEvent.class);
        JobStartEvent jse3 = JSON.parseObject("{\"Event\":\"SparkListenerJobStart\",\"Job ID\":3,\"Submission Time\":1636630211585,\"Stage Infos\":[{\"Stage ID\":15,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":12,\"Stage Attempt ID\":0,\"Stage Name\":\"parallelize at SparkTC.scala:50\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.SparkContext.parallelize(SparkContext.scala:716)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:50)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":16,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":13,\"Stage Attempt ID\":0,\"Stage Name\":\"map at SparkTC.scala:58\",\"Number of Tasks\":1,\"RDD Info\":[{\"RDD ID\":1,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:58\",\"Parent IDs\":[0],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[],\"Details\":\"org.apache.spark.rdd.RDD.map(RDD.scala:392)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:58)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":17,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":15,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[14],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":11,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[10],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":10,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[9,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":14,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"21\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[9,13],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":8,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[7],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":9,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[8],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":12,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"19\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[11],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":13,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"20\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[12],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[15,16,14],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":18,\"Stage Attempt ID\":0,\"Stage Name\":\"count at SparkTC.scala:76\",\"Number of Tasks\":4,\"RDD Info\":[{\"RDD ID\":17,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[16],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":16,\"Name\":\"ShuffledRDD\",\"Scope\":\"{\\\"id\\\":\\\"22\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[15],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":4,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[17],\"Details\":\"org.apache.spark.rdd.RDD.count(RDD.scala:1213)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:76)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]},{\"Stage ID\":14,\"Stage Attempt ID\":0,\"Stage Name\":\"distinct at SparkTC.scala:70\",\"Number of Tasks\":2,\"RDD Info\":[{\"RDD ID\":7,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"6\\\",\\\"name\\\":\\\"distinct\\\"}\",\"Callsite\":\"distinct at SparkTC.scala:70\",\"Parent IDs\":[6],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":4,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[3],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":6,\"Name\":\"UnionRDD\",\"Scope\":\"{\\\"id\\\":\\\"5\\\",\\\"name\\\":\\\"union\\\"}\",\"Callsite\":\"union at SparkTC.scala:70\",\"Parent IDs\":[0,5],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":2,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":0,\"Name\":\"ParallelCollectionRDD\",\"Scope\":\"{\\\"id\\\":\\\"0\\\",\\\"name\\\":\\\"parallelize\\\"}\",\"Callsite\":\"parallelize at SparkTC.scala:50\",\"Parent IDs\":[],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":true,\"Deserialized\":true,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":5,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"4\\\",\\\"name\\\":\\\"map\\\"}\",\"Callsite\":\"map at SparkTC.scala:70\",\"Parent IDs\":[4],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":3,\"Name\":\"MapPartitionsRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[2],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0},{\"RDD ID\":2,\"Name\":\"CoGroupedRDD\",\"Scope\":\"{\\\"id\\\":\\\"3\\\",\\\"name\\\":\\\"join\\\"}\",\"Callsite\":\"join at SparkTC.scala:70\",\"Parent IDs\":[0,1],\"Storage Level\":{\"Use Disk\":false,\"Use Memory\":false,\"Deserialized\":false,\"Replication\":1},\"Number of Partitions\":1,\"Number of Cached Partitions\":0,\"Memory Size\":0,\"Disk Size\":0}],\"Parent IDs\":[12,13],\"Details\":\"org.apache.spark.rdd.RDD.distinct(RDD.scala:427)\\norg.apache.spark.examples.SparkTC$.main(SparkTC.scala:70)\\norg.apache.spark.examples.SparkTC.main(SparkTC.scala)\\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\njava.lang.reflect.Method.invoke(Method.java:498)\\norg.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\",\"Accumulables\":[]}],\"Stage IDs\":[15,12,16,13,17,18,14],\"Properties\":{}}\n")
                .toJavaObject(JobStartEvent.class);
        List<JobStartEvent> jobs = new ArrayList<>();
        jobs.add(jse0);
        jobs.add(jse1);
        jobs.add(jse2);
        jobs.add(jse3);
        int[] ref = {32, 11, 9, 9, 9, 9, 9, 9, 7, 5, 2, 2, 2, 2, 2, 2, 2, 2};
        int[] directRef = {12, 5, 3, 3, 3, 3, 3, 5, 5, 5, 2, 2, 2, 2, 2, 2, 2, 2};
        int[] hopComputeTime = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17};
        float[] partitions = {1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 4, 4, 4, 4};
        {
            Map<Long, Float> ce = CacheSketcher.generateCostEffectiveness(jobs, null);
            for(int i = 0; i < 18; i++) {
                float value = (ref[i] - 1) * hopComputeTime[i] / partitions[i];
                System.out.println("rdd: " + i + " " + value);
                assertEquals(value, ce.get((long) i));
            }
        }
        {
            Map<Long, Float> logCe = CacheSketcher.generateLogCostEffectiveness(jobs, null);
            for(int i = 0; i < 18; i++) {
                float value = (ref[i] - 1) * (float) Math.log(hopComputeTime[i] / partitions[i] + 1);
                System.out.println("rdd: " + i + " " + value);
                assertEquals(Math.max(0, value), logCe.get((long) i));
            }
        }
        {
            Map<Long, Float> ce = CacheSketcher.generateDirectCostEffectiveness(jobs, null);
            for(int i = 0; i < 18; i++) {
                float value = (directRef[i] - 1) * hopComputeTime[i] / partitions[i];
                System.out.println("rdd: " + i + " " + value);
                assertEquals(value, ce.get((long) i));
            }
        }
        {
            Map<Long, Float> longCe = CacheSketcher.generateLogDirectCostEffectiveness(jobs, null);
            for(int i = 0; i < 18; i++) {
                float value = (directRef[i] - 1) * (float) Math.log(hopComputeTime[i] / partitions[i] + 1);
                System.out.println("rdd: " + i + " " + value);
                assertEquals(Math.max(0, value), longCe.get((long) i));
            }
        }
    }

}
